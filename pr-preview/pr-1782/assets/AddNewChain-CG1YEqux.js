import{e5 as J,e6 as W,bi as R,b1 as e,b2 as c,dQ as V,dO as X,bY as b,aY as w,a_ as h,bp as u,b$ as $,c$ as z,aZ as F,db as O,dq as ee,b0 as ae,d2 as Y,a$ as se,bq as ne,dT as ie,dU as te,__tla as re}from"./index-BUtJCI_S.js";import{u as L,__tla as le}from"./useMutation-BoJYpMPc.js";import{S as oe,__tla as ce}from"./Stepper-CAq1HHRY.js";import{g as de,__tla as he}from"./Common.utils-DgJGWld4.js";import{c as ue,a as U,u as pe,F as ge,b as xe,__tla as me}from"./index.esm-CwnKo2uA.js";import{i as fe,__tla as ye}from"./ValidationHelper-Z40PlQsk.js";import{C as be,__tla as we}from"./ContentLayout-BE32BUYy.js";let Q,_e=Promise.all([(()=>{try{return re}catch{}})(),(()=>{try{return le}catch{}})(),(()=>{try{return ce}catch{}})(),(()=>{try{return he}catch{}})(),(()=>{try{return me}catch{}})(),(()=>{try{return ye}catch{}})(),(()=>{try{return we}catch{}})()]).then(async()=>{let _,j,I,S,C,v,k,x,A,D,p,T,E,M,N;_=a=>a,j=a=>a,I=({userPushSDKInstance:a,alias:i})=>a.channel.alias.initiate(i).then(_),S=({userPushSDKInstance:a,alias:i})=>a.channel.alias.verify(i).then(j),C=()=>L({mutationKey:[J],mutationFn:I}),v=()=>L({mutationKey:[W],mutationFn:S}),k=[{label:"New Address",value:"newaddress"},{label:"Change Network",value:"changenetwork"},{label:"Verify Alias Chain",value:"verifyalias"}],x=R.allowedNetworks.filter(a=>a!=R.coreContractChain),A=ue().shape({alias:U().required("Address is required").test("is-valid-address","Invalid wallet address",fe),chainId:U().required("ChainId is required")}),D=({children:a,onSubmit:i})=>{const t=pe({initialValues:{alias:"",chainId:x[0].toString()},validationSchema:A,onSubmit:i});return e.jsx(ge,{value:t,children:a})},p=()=>{const a=xe();if(!a)throw new Error("useChainAliasFormikContext must be used within a FormikChainAliasProvider");return a},T=({isLoading:a})=>{const i=de(x),{values:t,handleSubmit:d,handleChange:o,errors:s,touched:n}=p();return e.jsx(c,{width:"100%",children:e.jsx("form",{onSubmit:d,children:e.jsxs(c,{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",gap:"spacing-xl",children:[e.jsxs(c,{display:"flex",flexDirection:{ml:"column",dp:"row"},gap:"spacing-xs",alignItems:"flex-start",width:"100%",children:[e.jsx(V,{label:"Your Address on New Chain",description:"Make sure you own this alias as verification will take place.",value:t.alias,onChange:o("alias"),error:(n==null?void 0:n.alias)&&!!(s!=null&&s.alias),errorMessage:n!=null&&n.alias?s==null?void 0:s.alias:""}),e.jsx(c,{display:"flex",alignSelf:"center",width:{dp:"auto",ml:"100%"},margin:"spacing-xxxs spacing-none spacing-none spacing-none",children:e.jsx(X,{options:i,value:t.chainId,onSelect:o("chainId"),error:(n==null?void 0:n.chainId)&&!!(s!=null&&s.chainId),errorMessage:n!=null&&n.chainId?s.chainId:""})})]}),e.jsx(b,{disabled:!t.alias,variant:"primary",loading:a,children:a?"Adding new chain":"Add"})]})})})},E=({handleNextStep:a})=>{const{switchChain:i,chainId:t}=w(),{values:d}=p(),o=parseInt(d.chainId);return h.useEffect(()=>{t===o&&a("verifyalias")},[t]),e.jsxs(c,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsx(u,{variant:"bs-semibold",color:"text-primary",children:"Switch to the desired chain in your wallet to add it to your channel."}),e.jsx(b,{onClick:()=>i(o),children:"Change Network"})]})},M=()=>{const{userPushSDKInstance:a}=$(r=>r.user),{account:i}=w(),{mutate:t,isPending:d}=v(),{values:o}=p(),s=z(),n=F(),m=parseInt(o.chainId),g=o.alias,f=()=>{t({userPushSDKInstance:a,alias:O(g,m)},{onSuccess:()=>{s.showMessageToast({toastTitle:"Success",toastMessage:"Verification Successful",toastType:"SUCCESS",getToastIcon:r=>e.jsx(ee,{size:r,color:"green"})}),n(`${ae.ChannelDashboard}/${i}}`)},onError:r=>{r&&s.showMessageToast({toastTitle:"Error",toastMessage:r.message,toastType:"ERROR",getToastIcon:y=>e.jsx(Y,{size:y,color:"red"})})}})};return e.jsxs(c,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsxs(c,{display:"flex",flexDirection:"column",gap:"spacing-sm",children:[e.jsxs(u,{variant:"bs-semibold",textAlign:"center",color:"text-primary",children:["You\u2019re almost there!",e.jsx("br",{})," Verify the address on the new chain to send notifications."]}),e.jsx(V,{disabled:!0,value:g})]}),e.jsx(b,{onClick:f,loading:d,children:d?"Verifying":"Verify New Address"})]})},N=()=>{const[a,i]=h.useState("newaddress"),[t,d]=h.useState(["newaddress"]),[o,s]=h.useState(!0),n=z(),{mutate:m,isPending:g,isError:f}=C(),{userPushSDKInstance:r}=$(l=>l.user),{account:y}=w(),{data:P}=se(y),Z=F();h.useEffect(()=>{s(r&&(r==null?void 0:r.readmode()))},[r]),h.useEffect(()=>{P||Z("/channels")},[P]);const B=(l,G)=>{m({userPushSDKInstance:r,alias:O(l,parseInt(G))},{onSuccess:()=>{K("changenetwork")},onError:q=>{q&&n.showMessageToast({toastTitle:"Error",toastMessage:q.message,toastType:"ERROR",getToastIcon:H=>e.jsx(Y,{size:H,color:"red"})})}})},K=l=>{d([...new Set([...t,l])]),i(l)};return e.jsx(D,{onSubmit:l=>B(l.alias,l.chainId),children:e.jsxs(c,{display:"flex",flexDirection:"column",alignItems:"center",margin:{ml:"spacing-lg spacing-md",dp:"spacing-lg spacing-none spacing-none spacing-none"},padding:{dp:"spacing-lg",ml:"spacing-sm"},gap:"spacing-lg",borderRadius:"radius-lg",backgroundColor:"surface-primary",children:[e.jsxs(c,{display:"flex",flexDirection:"column",alignItems:"center",gap:"spacing-xxxs",children:[e.jsx(u,{color:"text-primary",variant:"h3-semibold",display:{ml:"none",dp:"block"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-primary",variant:"h4-semibold",display:{ml:"block",dp:"none"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-tertiary",variant:"bs-regular",display:{ml:"none",dp:"block"},children:"Add an alias chain to your channel to enable notifications to that chain."}),e.jsx(u,{display:{ml:"block",dp:"none"},color:"text-tertiary",variant:"bes-regular",children:"Add an alias chain to your channel to enable notifications to that chain."})]}),e.jsx(oe,{steps:k,completedSteps:t,setActiveStepKey:l=>i(l)}),a==="newaddress"&&e.jsx(T,{isLoading:g&&!f}),a==="changenetwork"&&e.jsx(E,{handleNextStep:K}),a==="verifyalias"&&e.jsx(M,{}),o&&e.jsx(c,{display:"flex",justifyContent:"center",width:"-webkit-fill-available",alignItems:"center",css:ne`
              z-index: 99999;
            `,children:e.jsx(ie,{type:te.MODAL,showConnectModal:!0,onClose:()=>s(!1)})})]})})},Q=()=>e.jsx(be,{children:e.jsx(N,{})})});export{_e as __tla,Q as default};
