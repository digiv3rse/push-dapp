import{ep as G,eq as H,b$ as w,cT as J,er as W,bi as V,b1 as e,b2 as o,dQ as z,dO as X,bY as _,aY as O,a_ as p,bp as u,c$ as Y,aZ as ee,es as ae,dq as se,b0 as ne,d2 as $,bq as te,dT as ie,dU as re,db as le,__tla as oe}from"./index-DG711wyd.js";import{S as ce,__tla as de}from"./Stepper-BcbqO2Ot.js";import{u as L,__tla as he}from"./useMutation-j5ba--Kl.js";import{g as ue,__tla as pe}from"./Common.utils-Bxsp_DWw.js";import{c as ge,a as U,u as xe,F as me,b as ye,__tla as fe}from"./index.esm-BZp2Uru8.js";import{i as be,__tla as we}from"./ValidationHelper-0GVvp9KZ.js";import{C as _e,__tla as je}from"./ContentLayout-TzJzfE-U.js";let Q,Ie=Promise.all([(()=>{try{return oe}catch{}})(),(()=>{try{return de}catch{}})(),(()=>{try{return he}catch{}})(),(()=>{try{return pe}catch{}})(),(()=>{try{return fe}catch{}})(),(()=>{try{return we}catch{}})(),(()=>{try{return je}catch{}})()]).then(async()=>{let j,I,S,v,C,k,D,A,T,K,y,P,E,g,M,N,q,R;j=a=>a,I=a=>a,S=a=>a,v=({userPushSDKInstance:a,alias:s})=>a.channel.alias.initiate(s).then(j),C=({userPushSDKInstance:a,channelAddress:s})=>a.channel.alias.verify(s).then(I),k=({userPushSDKInstance:a,options:s})=>a.channel.alias.info(s).then(S),D=()=>L({mutationKey:[G],mutationFn:v}),A=()=>L({mutationKey:[H],mutationFn:C}),T=a=>{const{userPushSDKInstance:s}=w(t=>t.user);return J({queryKey:[W,a],queryFn:()=>k({userPushSDKInstance:s,options:a})})},K=[{label:"New Address",value:"newaddress"},{label:"Change Network",value:"changenetwork"},{label:"Verify Alias Chain",value:"verifyalias"}],y=V.allowedNetworks.filter(a=>a!=V.coreContractChain),P=ge().shape({alias:U().required("Address is required").test("is-valid-address","Invalid wallet address",be),chainId:U().required("ChainId is required")}),E=({children:a,onSubmit:s})=>{const t=xe({initialValues:{alias:"",chainId:y[0].toString()},validationSchema:P,onSubmit:s});return e.jsx(me,{value:t,children:a})},g=()=>{const a=ye();if(!a)throw new Error("useChainAliasFormikContext must be used within a FormikChainAliasProvider");return a},M=({isLoading:a})=>{const s=ue(y),{values:t,handleSubmit:c,handleChange:l,errors:i,touched:n}=g();return e.jsx(o,{width:"100%",children:e.jsx("form",{onSubmit:c,children:e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",gap:"spacing-xl",children:[e.jsxs(o,{display:"flex",flexDirection:{ml:"column",dp:"row"},gap:"spacing-xs",alignItems:"flex-start",width:"100%",children:[e.jsx(z,{label:"Your Address on New Chain",description:"Make sure you own this alias as verification will take place.",value:t.alias,onChange:l("alias"),error:(n==null?void 0:n.alias)&&!!(i!=null&&i.alias),errorMessage:n!=null&&n.alias?i==null?void 0:i.alias:""}),e.jsx(o,{display:"flex",alignSelf:"center",width:{dp:"auto",ml:"100%"},margin:"spacing-xxxs spacing-none spacing-none spacing-none",children:e.jsx(X,{options:s,value:t.chainId,onSelect:l("chainId"),error:(n==null?void 0:n.chainId)&&!!(i!=null&&i.chainId),errorMessage:n!=null&&n.chainId?i.chainId:""})})]}),e.jsx(_,{disabled:!t.alias,variant:"primary",loading:a,children:a?"Adding new chain":"Add"})]})})})},N=({handleNextStep:a})=>{const{switchChain:s,chainId:t}=O(),{values:c}=g(),l=parseInt(c.chainId);return p.useEffect(()=>{t===l&&a("verifyalias")},[t]),e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsx(u,{variant:"bs-semibold",color:"text-primary",children:"Switch to the desired chain in your wallet to add it to your channel."}),e.jsx(_,{onClick:()=>s(l),children:"Change Network"})]})},q=()=>{const{userPushSDKInstance:a}=w(h=>h.user),{account:s}=O(),{mutate:t,isPending:c}=A(),{values:l}=g(),i=parseInt(l.chainId),{data:n}=T({alias:s,aliasChain:ae[i]}),f=l.alias,x=Y(),b=ee(),d=()=>{t({userPushSDKInstance:a,channelAddress:(n==null?void 0:n.channel)??""},{onSuccess:()=>{x.showMessageToast({toastTitle:"Success",toastMessage:"Verification Successful",toastType:"SUCCESS",getToastIcon:h=>e.jsx(se,{size:h,color:"green"})}),b(`${ne.ChannelDashboard}/${s}}`)},onError:h=>{h&&x.showMessageToast({toastTitle:"Error",toastMessage:h.message,toastType:"ERROR",getToastIcon:m=>e.jsx($,{size:m,color:"red"})})}})};return e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-sm",children:[e.jsxs(u,{variant:"bs-semibold",textAlign:"center",color:"text-primary",children:["You\u2019re almost there!",e.jsx("br",{})," Verify the address on the new chain to send notifications."]}),e.jsx(z,{disabled:!0,value:f})]}),e.jsx(_,{onClick:d,loading:c,children:c?"Verifying":"Verify New Address"})]})},R=()=>{const[a,s]=p.useState("newaddress"),[t,c]=p.useState(["newaddress"]),[l,i]=p.useState(!0),n=Y(),{mutate:f,isPending:x,isError:b}=D(),{userPushSDKInstance:d}=w(r=>r.user);p.useEffect(()=>{i(d&&(d==null?void 0:d.readmode()))},[d]);const h=(r,Z)=>{f({userPushSDKInstance:d,alias:le(r,parseInt(Z))},{onSuccess:()=>{m("changenetwork")},onError:F=>{F&&n.showMessageToast({toastTitle:"Error",toastMessage:F.message,toastType:"ERROR",getToastIcon:B=>e.jsx($,{size:B,color:"red"})})}})},m=r=>{c([...new Set([...t,r])]),s(r)};return e.jsx(E,{onSubmit:r=>h(r.alias,r.chainId),children:e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",margin:{ml:"spacing-lg spacing-md",dp:"spacing-lg spacing-none spacing-none spacing-none"},padding:{dp:"spacing-lg",ml:"spacing-sm"},gap:"spacing-lg",borderRadius:"radius-lg",backgroundColor:"surface-primary",children:[e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",gap:"spacing-xxxs",children:[e.jsx(u,{color:"text-primary",variant:"h3-semibold",display:{ml:"none",dp:"block"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-primary",variant:"h4-semibold",display:{ml:"block",dp:"none"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-tertiary",variant:"bs-regular",display:{ml:"none",dp:"block"},children:"Add an alias chain to your channel to enable notifications to that chain."}),e.jsx(u,{display:{ml:"block",dp:"none"},color:"text-tertiary",variant:"bes-regular",children:"Add an alias chain to your channel to enable notifications to that chain."})]}),e.jsx(ce,{steps:K,completedSteps:t,setActiveStepKey:r=>s(r)}),a==="newaddress"&&e.jsx(M,{isLoading:x&&!b}),a==="changenetwork"&&e.jsx(N,{handleNextStep:m}),a==="verifyalias"&&e.jsx(q,{}),l&&e.jsx(o,{display:"flex",justifyContent:"center",width:"-webkit-fill-available",alignItems:"center",css:te`
              z-index: 99999;
            `,children:e.jsx(ie,{type:re.MODAL,showConnectModal:!0,onClose:()=>i(!1)})})]})})},Q=()=>e.jsx(_e,{children:e.jsx(R,{})})});export{Ie as __tla,Q as default};
