import{b1 as i,bo as yn,bj as Ae,bk as ve,bl as Ge,fX as vn,b2 as c,dL as He,dM as wn,bX as D,bp as x,cn as jn,cp as bn,fY as Sn,aY as we,bi as je,cl as In,e$ as le,dN as Cn,du as Pn,cm as En,a$ as E,bq as Je,fZ as _n,f_ as kn,cJ as ce,f$ as Ve,cx as ze,g0 as Un,g1 as Tn,bm as Ln,g2 as Dn,bn as Mn,g3 as Nn,g4 as Bn,fp as On,fu as Fn,__tla as Rn}from"./index-DM7ZIfOI.js";import{E as An,__tla as Gn}from"./ErrorFilled-DJsPB_xi.js";import{S as Hn,__tla as Jn}from"./Stepper-BgnDZO76.js";import{S as Vn,I as zn,u as Wn,__tla as Kn}from"./ImageClipper-BMCT1ZEo.js";import{u as qn,__tla as Xn}from"./useMutation-bNQo4QqD.js";import{c as Yn,a as be,u as $n,F as Zn,b as Qn,__tla as er}from"./index.esm-Bs7nMujD.js";import{g as Se,a as We,U as tr}from"./Common.form-LPxQflxb.js";import{m as nr,c as rr,i as ir,__tla as ar}from"./PushTokenContractHelper-BCFi3VC4.js";let Ke,sr=Promise.all([(()=>{try{return Rn}catch{}})(),(()=>{try{return Gn}catch{}})(),(()=>{try{return Jn}catch{}})(),(()=>{try{return Kn}catch{}})(),(()=>{try{return Xn}catch{}})(),(()=>{try{return er}catch{}})(),(()=>{try{return ar}catch{}})()]).then(async()=>{const qe=e=>{const{svgProps:t,...n}=e;return i.jsx(yn,{componentName:"CloudUpload",icon:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"inherit",height:"inherit",viewBox:"0 0 53 52",fill:"none",...t,children:[i.jsx("path",{d:"M16.1888 26.3978L26.7966 15.7901L37.4043 26.3978",stroke:"#C4CBD5","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),i.jsx("path",{d:"M27.0618 50.0001V16.8509",stroke:"#C4CBD5","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),i.jsx("path",{d:"M21.4927 35.4144H11.1502C8.05625 35.0608 1.86841 32.4972 1.86841 25.0718C1.86841 17.6464 8.05625 14.9061 11.1502 14.4641C11.769 10.3094 15.6585 2 26.2662 2C39.2607 2 41.0286 10.8398 41.9126 16.0553C45.0065 15.9669 51.4596 19.2906 51.4596 26.9282C51.2828 29.7569 49.6032 35.4144 44.2993 35.4144C38.9955 35.4144 34.1336 35.4144 32.3656 35.4144",stroke:"#C4CBD5","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"})]}),...n})},Xe=async e=>{const{channelType:t,identityBytes:n,fees:r,signer:a}=e;return(await new Ae(ve.epnscore,Ge.epnscore,a).createChannelWithPUSH(t,n,r,0,{gasLimit:6e5})).wait()},Ye=()=>qn({mutationKey:[vn],mutationFn:Xe}),$e=Yn().shape({channelName:be().required(Se("Channel Name")).max(32,We(32)),channelDesc:be().required(Se("Channel Description")).max(250,We(250)),channelURL:be().required(Se("Channel URL")).test("url","Please enter a valid channel url",e=>tr.test(e))}),Ze=({children:e,onSubmit:t})=>{const n=$n({initialValues:{channelName:"",channelDesc:"",channelURL:"",image:null},validationSchema:$e,onSubmit:t});return i.jsx(Zn,{value:n,children:e})},de=()=>{const e=Qn();if(!e)throw new Error("useChainAliasFormikContext must be used within a FormikChainAliasProvider");return e},Qe=({handleNextStep:e,setActiveStepKey:t})=>{const{values:n,touched:r,setFieldTouched:a,setFieldValue:s,errors:o,validateForm:p,setTouched:j}=de(),m=()=>{p().then(l=>{j({channelName:!0,channelDesc:!0,channelURL:!0}),Object.keys(l).length===0&&(e("uploadLogo"),t("uploadLogo"))})};return i.jsx(c,{display:"flex",flexDirection:"column",alignSelf:"stretch",children:i.jsxs(c,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignSelf:"stretch",children:[i.jsxs(c,{display:"flex",flexDirection:"column",gap:"spacing-sm",alignSelf:"stretch",children:[i.jsx(He,{required:!0,label:"Channel Name",value:n.channelName,onChange:l=>{const d=l.target.value;a("channelName",!0),s("channelName",d)},totalCount:32,error:r.channelName&&!!(o!=null&&o.channelName),errorMessage:r.channelName?o==null?void 0:o.channelName:""}),i.jsx(wn,{required:!0,label:"Channel Description",placeholder:"Get notified about ...",description:"Enter a Brief description of the notifications the user will receive",value:n.channelDesc,onChange:l=>{const d=l.target.value;a("channelDesc",!0),s("channelDesc",d)},totalCount:250,error:r.channelDesc&&!!(o!=null&&o.channelDesc),errorMessage:r.channelURL?o==null?void 0:o.channelDesc:""}),i.jsx(He,{required:!0,label:"Channel Website URL",value:n.channelURL,onChange:l=>{const d=l.target.value;a("channelURL",!0),s("channelURL",d)},error:r.channelURL&&!!(o!=null&&o.channelURL),errorMessage:r.channelURL?o==null?void 0:o.channelURL:""})]}),i.jsx(c,{display:"flex",justifyContent:"center",children:i.jsx(D,{onClick:m,children:"Next"})})]})})},he=50,et=[{label:"Channel Info",value:"channelInfo"},{label:"Upload Logo",value:"uploadLogo"},{label:"Stake Fees",value:"stakeFees"}],A={progress:null,progressInfo:"",processingInfo:""},Ie={txErrorStatus:0,txError:""},tt=()=>i.jsxs(c,{display:"flex",flexDirection:"column",alignItems:"center",gap:"spacing-xxs",alignSelf:"stretch",children:[i.jsx(x,{variant:"h3-semibold",color:"text-primary",display:{ml:"none",dp:"block"},children:"Create Your Channel"}),i.jsx(x,{variant:"bs-regular",color:"text-tertiary",display:{ml:"none",dp:"block"},children:"Creating your own notification channel to manage, send and notify users."}),i.jsx(x,{variant:"h4-semibold",color:"text-primary",display:{ml:"block",dp:"none"},children:"Create Your Channel"}),i.jsx(x,{variant:"bes-regular",color:"text-tertiary",display:{ml:"block",dp:"none"},textAlign:"center",children:"Creating your own notification channel to manage, send and notify users."})]}),nt=({progressState:e})=>i.jsxs(c,{display:"flex",flexDirection:"column",alignSelf:"stretch",gap:"spacing-xl",alignItems:"center",children:[i.jsx(c,{padding:"s6",backgroundColor:"surface-secondary",borderRadius:"radius-sm",width:"-webkit-fill-available",children:i.jsx(x,{textAlign:"center",variant:"h5-semibold",color:"text-brand-medium",children:e.progressInfo})}),i.jsx(c,{width:"400px",children:i.jsx(jn,{percent:e.progress,color:"#D548EC",backgroundColor:"#F3AEFF",height:"4px"})}),i.jsxs(c,{display:"flex",flexDirection:"row",alignItems:"center",gap:"spacing-xxxs",children:[i.jsx(bn,{type:Sn.PROCESSING,size:16,color:"#D548EC"}),i.jsx(x,{variant:"bs-semibold",color:"text-secondary",children:e.processingInfo})]})]}),rt=()=>{const{switchChain:e}=we();return i.jsxs(i.Fragment,{children:[i.jsx(c,{display:"flex",flexDirection:"column",padding:"spacing-md",backgroundColor:"surface-secondary",borderRadius:"radius-sm",width:"-webkit-fill-available",children:i.jsx(x,{textAlign:"center",variant:"h5-semibold",color:"text-brand-medium",children:"Please select Ethereum Sepolia Network in your Wallet to create a channel."})}),i.jsx(c,{display:"flex",justifyContent:"center",children:i.jsx(D,{onClick:()=>e(je.coreContractChain),children:"Change Network"})})]})},it=({mintPushToken:e,noOfPushTokensToCheck:t,mintingPush:n})=>{const r=je.appEnv==="prod",{isModalOpen:a,showModal:s,ModalComponent:o}=In();return i.jsxs(c,{display:"flex",padding:"spacing-sm spacing-md",backgroundColor:"surface-brand-subtle",borderRadius:"radius-none radius-none radius-sm radius-sm",justifyContent:"space-between",alignItems:"center",flexDirection:{ml:"column",initial:"row"},gap:"spacing-xs",children:[i.jsx(le,{isLoading:n,children:i.jsx(x,{variant:"c-regular",color:"text-primary",children:r?"Your balance is low. Swap to get PUSH Tokens.":"Follow these steps to get Testnet PUSH."})}),r?i.jsx(D,{size:"extraSmall",leadingIcon:i.jsx(Vn,{}),onClick:s,children:"Swap PUSH Token"}):i.jsxs(c,{display:"flex",gap:"spacing-xs",children:[i.jsx(le,{isLoading:n,children:i.jsx(Cn,{to:"https://chaindrop.org/?chainid=11155111&token=0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",target:"_blank",children:i.jsxs(c,{display:"flex",gap:"spacing-xxs",alignItems:"baseline",color:"text-brand-medium",cursor:"pointer",children:[i.jsx(c,{border:"border-sm solid stroke-brand-medium",width:"16px",height:"15px",borderRadius:"radius-xl",display:"flex",justifyContent:"center",children:i.jsx(x,{variant:"c-regular",children:"1"})}),i.jsx(x,{children:"Sepolia ETH Faucet"})]})})}),i.jsx(le,{isLoading:n,children:i.jsxs(c,{display:"flex",gap:"spacing-xxs",alignItems:"baseline",color:"text-brand-medium",cursor:"pointer",onClick:()=>e(1e3),children:[i.jsx(c,{border:"border-sm solid stroke-brand-medium",width:"16px",height:"15px",borderRadius:"radius-xl",display:"flex",justifyContent:"center",children:i.jsx(x,{variant:"c-regular",children:"2"})}),i.jsx(x,{children:"Get Testnet Push"})]})})]}),a&&i.jsx(o,{InnerComponent:Pn,InnerComponentProps:{defaultPushTokenAmount:t},modalPadding:"0px",modalPosition:En.ON_ROOT})]})},at=({channelStakeFees:e,handleNextStep:t})=>{const n=he,{provider:r,account:a,isWalletConnected:s,connect:o}=we(),[p,j]=E.useState(0),[m,l]=E.useState(!1),[d,b]=E.useState(!1),k=async v=>{if(s||o(),s){l(!0);try{const U=await nr({noOfTokens:v,provider:r,account:a});l(!1),j(U)}catch(U){console.log("Error >>",U),l(!1)}}},y=async()=>{b(!0);const v=await rr({address:a,provider:r});b(!1),j(v)};E.useEffect(()=>{y()},[p,a]);const g=async()=>{s&&await ir()},h=p<n,{handleSubmit:f,validateForm:P}=de(),w=()=>{P().then(v=>{(v.channelName||v.channelDesc||v.channelURL)&&t("channelInfo"),v.image&&t("uploadLogo"),Object.keys(v).length||f()})};return i.jsxs(c,{display:"flex",flexDirection:"column",alignSelf:"stretch",justifyContent:"center",gap:"spacing-xl",children:[i.jsxs(c,{display:"flex",flexDirection:"column",gap:"spacing-sm",children:[i.jsxs(c,{display:"flex",flexDirection:"column",alignSelf:"stretch",children:[i.jsxs(c,{display:"flex",flexDirection:"row",justifyContent:"space-between",backgroundColor:"surface-secondary",borderRadius:h?"radius-sm radius-sm radius-none radius-none":"radius-sm",padding:"spacing-sm spacing-md",alignItems:"center",children:[i.jsx(x,{variant:"h4-semibold",color:"text-primary",display:{ml:"none",dp:"block"},children:"Amount for Staking"}),i.jsx(x,{variant:"h5-semibold",color:"text-primary",display:{ml:"block",dp:"none"},children:"Amout For Staking"}),i.jsxs(c,{children:[i.jsxs(x,{variant:"h4-semibold",color:"text-brand-medium",children:[e," PUSH"]}),i.jsx(le,{isLoading:d,children:i.jsxs(x,{variant:"bes-semibold",color:"text-tertiary",children:["Balance: ",p==null?void 0:p.toLocaleString()]})})]})]}),h&&i.jsx(it,{mintPushToken:k,noOfPushTokensToCheck:50,mintingPush:m})]}),i.jsxs(c,{display:"flex",flexDirection:"row",gap:"spacing-xxs",justifyContent:"center",children:[i.jsx(x,{variant:"bes-semibold",color:"text-tertiary",children:"Don't see Push token in your wallet?"}),i.jsx(x,{css:Je`
              cursor: pointer;
            `,variant:"bes-semibold",color:"text-brand-medium",onClick:g,children:"Import Token"})]})]}),i.jsx(c,{display:"flex",justifyContent:"center",children:i.jsx(D,{disabled:m,onClick:()=>{w()},children:"Create Channel"})})]})};var Ce={exports:{}},ue={exports:{}},st=kn(),Pe=_n().EventEmitter;ue.exports=I,ue.exports.default=I;function I(e){if(!(this instanceof I))return new I(e);Pe.call(this),e=e||{},this.concurrency=e.concurrency||1/0,this.timeout=e.timeout||0,this.autostart=e.autostart||!1,this.results=e.results||null,this.pending=0,this.session=0,this.running=!1,this.jobs=[],this.timers={}}st(I,Pe);var ot=["pop","shift","indexOf","lastIndexOf"];ot.forEach(function(e){I.prototype[e]=function(){return Array.prototype[e].apply(this.jobs,arguments)}}),I.prototype.slice=function(e,t){return this.jobs=this.jobs.slice(e,t),this},I.prototype.reverse=function(){return this.jobs.reverse(),this};var lt=["push","unshift","splice"];lt.forEach(function(e){I.prototype[e]=function(){var t=Array.prototype[e].apply(this.jobs,arguments);return this.autostart&&this.start(),t}}),Object.defineProperty(I.prototype,"length",{get:function(){return this.pending+this.jobs.length}}),I.prototype.start=function(e){if(e&&dt.call(this,e),this.running=!0,this.pending>=this.concurrency)return;if(this.jobs.length===0){this.pending===0&&pe.call(this);return}var t=this,n=this.jobs.shift(),r=!0,a=this.session,s=null,o=!1,p=null,j=n.timeout||this.timeout;function m(d,b){r&&t.session===a&&(r=!1,t.pending--,s!==null&&(delete t.timers[s],clearTimeout(s)),d?t.emit("error",d,n):o===!1&&(p!==null&&(t.results[p]=Array.prototype.slice.call(arguments,1)),t.emit("success",b,n)),t.session===a&&(t.pending===0&&t.jobs.length===0?pe.call(t):t.running&&t.start()))}j&&(s=setTimeout(function(){o=!0,t.listeners("timeout").length>0?t.emit("timeout",m,n):m()},j),this.timers[s]=s),this.results&&(p=this.results.length,this.results[p]=null),this.pending++,t.emit("start",n);var l=n(m);l&&l.then&&typeof l.then=="function"&&l.then(function(d){return m(null,d)}).catch(function(d){return m(d||!0)}),this.running&&this.jobs.length>0&&this.start()},I.prototype.stop=function(){this.running=!1},I.prototype.end=function(e){ct.call(this),this.jobs.length=0,this.pending=0,pe.call(this,e)};function ct(){for(var e in this.timers){var t=this.timers[e];delete this.timers[e],clearTimeout(t)}}function dt(e){var t=this;this.on("error",n),this.on("end",r);function n(a){t.end(a)}function r(a){t.removeListener("error",n),t.removeListener("end",r),e(a,this.results)}}function pe(e){this.session++,this.running=!1,this.emit("end",e)}var ht=ue.exports,M={},G={};Object.defineProperty(G,"__esModule",{value:!0}),G.BMP=void 0,G.BMP={validate(e){return e.toString("ascii",0,2)==="BM"},calculate(e){return{height:Math.abs(e.readInt32LE(22)),width:e.readUInt32LE(18)}}};var H={},N={};Object.defineProperty(N,"__esModule",{value:!0}),N.ICO=void 0;const ut=1,pt=6,gt=16;function Ee(e,t){const n=e.readUInt8(t);return n===0?256:n}function _e(e,t){const n=pt+t*gt;return{height:Ee(e,n+1),width:Ee(e,n)}}N.ICO={validate(e){return e.readUInt16LE(0)!==0?!1:e.readUInt16LE(2)===ut},calculate(e){const t=e.readUInt16LE(4),n=_e(e,0);if(t===1)return n;const r=[n];for(let a=1;a<t;a+=1)r.push(_e(e,a));return{height:n.height,images:r,width:n.width}}},Object.defineProperty(H,"__esModule",{value:!0}),H.CUR=void 0;const ft=N,mt=2;H.CUR={validate(e){return e.readUInt16LE(0)!==0?!1:e.readUInt16LE(2)===mt},calculate(e){return ft.ICO.calculate(e)}};var J={};Object.defineProperty(J,"__esModule",{value:!0}),J.DDS=void 0,J.DDS={validate(e){return e.readUInt32LE(0)===542327876},calculate(e){return{height:e.readUInt32LE(12),width:e.readUInt32LE(16)}}};var V={};Object.defineProperty(V,"__esModule",{value:!0}),V.GIF=void 0;const xt=/^GIF8[79]a/;V.GIF={validate(e){const t=e.toString("ascii",0,6);return xt.test(t)},calculate(e){return{height:e.readUInt16LE(8),width:e.readUInt16LE(6)}}};var z={};Object.defineProperty(z,"__esModule",{value:!0}),z.ICNS=void 0;const yt=8,vt=4,wt=4,jt={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function ke(e,t){const n=t+wt;return[e.toString("ascii",t,n),e.readUInt32BE(n)]}function Ue(e){const t=jt[e];return{width:t,height:t,type:e}}z.ICNS={validate(e){return e.toString("ascii",0,4)==="icns"},calculate(e){const t=e.length,n=e.readUInt32BE(vt);let r=yt,a=ke(e,r),s=Ue(a[0]);if(r+=a[1],r===n)return s;const o={height:s.height,images:[s],width:s.width};for(;r<n&&r<t;)a=ke(e,r),s=Ue(a[0]),r+=a[1],o.images.push(s);return o}};var W={};Object.defineProperty(W,"__esModule",{value:!0}),W.J2C=void 0,W.J2C={validate(e){return e.toString("hex",0,4)==="ff4fff51"},calculate(e){return{height:e.readUInt32BE(12),width:e.readUInt32BE(8)}}};var K={};Object.defineProperty(K,"__esModule",{value:!0}),K.JP2=void 0;const q={ftyp:"66747970",ihdr:"69686472",jp2h:"6a703268",jp__:"6a502020",rreq:"72726571",xml_:"786d6c20"},bt=e=>{const t=e.readUInt8(0);let n=1+2*t;const r=e.readUInt16BE(n)*(2+t);n=n+2+r;const a=e.readUInt16BE(n)*(16+t);return n+2+a},Te=e=>({height:e.readUInt32BE(4),width:e.readUInt32BE(8)});K.JP2={validate(e){const t=e.toString("hex",4,8),n=e.readUInt32BE(0);if(t!==q.jp__||n<1)return!1;const r=n+4,a=e.readUInt32BE(n);return e.slice(r,r+a).toString("hex",0,4)===q.ftyp},calculate(e){const t=e.readUInt32BE(0),n=e.readUInt16BE(t+2);let r=t+4+n;switch(e.toString("hex",r,r+4)){case q.rreq:return r=r+4+4+bt(e.slice(r+4)),Te(e.slice(r+8,r+24));case q.jp2h:return Te(e.slice(r+8,r+24));default:throw new TypeError("Unsupported header found: "+e.toString("ascii",r,r+4))}}};var X={},B={};Object.defineProperty(B,"__esModule",{value:!0}),B.readUInt=void 0;function St(e,t,n,r){n=n||0;const a=r?"BE":"LE",s="readUInt"+t+a;return e[s].call(e,n)}B.readUInt=St,Object.defineProperty(X,"__esModule",{value:!0}),X.JPG=void 0;const O=B,It="45786966",Ct=2,ge=6,Pt=2,Et="4d4d",_t="4949",Le=12,kt=2;function Ut(e){return e.toString("hex",2,6)===It}function Tt(e,t){return{height:e.readUInt16BE(t),width:e.readUInt16BE(t+2)}}function Lt(e,t){const n=ge+8,r=O.readUInt(e,16,n,t);for(let a=0;a<r;a++){const s=n+kt+a*Le,o=s+Le;if(s>e.length)return;const p=e.slice(s,o);if(O.readUInt(p,16,0,t)===274)return O.readUInt(p,16,2,t)!==3||O.readUInt(p,32,4,t)!==1?void 0:O.readUInt(p,16,8,t)}}function Dt(e,t){const n=e.slice(Ct,t),r=n.toString("hex",ge,ge+Pt),a=r===Et;if(a||r===_t)return Lt(n,a)}function Mt(e,t){if(t>e.length)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(e[t]!==255)throw new TypeError("Invalid JPG, marker table corrupted")}X.JPG={validate(e){return e.toString("hex",0,2)==="ffd8"},calculate(e){e=e.slice(4);let t,n;for(;e.length;){const r=e.readUInt16BE(0);if(Ut(e)&&(t=Dt(e,r)),Mt(e,r),n=e[r+1],n===192||n===193||n===194){const a=Tt(e,r+5);return t?{height:a.height,orientation:t,width:a.width}:a}e=e.slice(r+2)}throw new TypeError("Invalid JPG, no size found")}};var Y={};Object.defineProperty(Y,"__esModule",{value:!0}),Y.KTX=void 0;const Nt="KTX 11";Y.KTX={validate(e){return Nt===e.toString("ascii",1,7)},calculate(e){return{height:e.readUInt32LE(40),width:e.readUInt32LE(36)}}};var $={};Object.defineProperty($,"__esModule",{value:!0}),$.PNG=void 0;const Bt=`PNG\r

`,Ot="IHDR",De="CgBI";$.PNG={validate(e){if(Bt===e.toString("ascii",1,8)){let t=e.toString("ascii",12,16);if(t===De&&(t=e.toString("ascii",28,32)),t!==Ot)throw new TypeError("Invalid PNG");return!0}return!1},calculate(e){return e.toString("ascii",12,16)===De?{height:e.readUInt32BE(36),width:e.readUInt32BE(32)}:{height:e.readUInt32BE(20),width:e.readUInt32BE(16)}}};var Z={};Object.defineProperty(Z,"__esModule",{value:!0}),Z.PNM=void 0;const Me={P1:"pbm/ascii",P2:"pgm/ascii",P3:"ppm/ascii",P4:"pbm",P5:"pgm",P6:"ppm",P7:"pam",PF:"pfm"},Ft=Object.keys(Me),Ne={default:e=>{let t=[];for(;e.length>0;){const n=e.shift();if(n[0]!=="#"){t=n.split(" ");break}}if(t.length===2)return{height:parseInt(t[1],10),width:parseInt(t[0],10)};throw new TypeError("Invalid PNM")},pam:e=>{const t={};for(;e.length>0;){const n=e.shift();if(n.length>16||n.charCodeAt(0)>128)continue;const[r,a]=n.split(" ");if(r&&a&&(t[r.toLowerCase()]=parseInt(a,10)),t.height&&t.width)break}if(t.height&&t.width)return{height:t.height,width:t.width};throw new TypeError("Invalid PAM")}};Z.PNM={validate(e){const t=e.toString("ascii",0,2);return Ft.includes(t)},calculate(e){const t=e.toString("ascii",0,2),n=Me[t],r=e.toString("ascii",3).split(/[\r\n]+/);return(Ne[n]||Ne.default)(r)}};var Q={};Object.defineProperty(Q,"__esModule",{value:!0}),Q.PSD=void 0,Q.PSD={validate(e){return e.toString("ascii",0,4)==="8BPS"},calculate(e){return{height:e.readUInt32BE(14),width:e.readUInt32BE(18)}}};var ee={};Object.defineProperty(ee,"__esModule",{value:!0}),ee.SVG=void 0;const Be=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/,te={height:/\sheight=(['"])([^%]+?)\1/,root:Be,viewbox:/\sviewBox=(['"])(.+?)\1/,width:/\swidth=(['"])([^%]+?)\1/},fe=2.54,Rt={cm:96/fe,em:16,ex:8,m:96/fe*100,mm:96/fe/10,pc:96/72/12,pt:96/72};function ne(e){const t=/([0-9.]+)([a-z]*)/.exec(e);if(t)return Math.round(parseFloat(t[1])*(Rt[t[2]]||1))}function At(e){const t=e.split(" ");return{height:ne(t[3]),width:ne(t[2])}}function Gt(e){const t=e.match(te.width),n=e.match(te.height),r=e.match(te.viewbox);return{height:n&&ne(n[2]),viewbox:r&&At(r[2]),width:t&&ne(t[2])}}function Ht(e){return{height:e.height,width:e.width}}function Jt(e,t){const n=t.width/t.height;return e.width?{height:Math.floor(e.width/n),width:e.width}:e.height?{height:e.height,width:Math.floor(e.height*n)}:{height:t.height,width:t.width}}ee.SVG={validate(e){const t=String(e);return Be.test(t)},calculate(e){const t=e.toString("utf8").match(te.root);if(t){const n=Gt(t[0]);if(n.width&&n.height)return Ht(n);if(n.viewbox)return Jt(n,n.viewbox)}throw new TypeError("Invalid SVG")}};var re={};Object.defineProperty(re,"__esModule",{value:!0}),re.TIFF=void 0;const ie=Ve,L=B;function Vt(e,t,n){const r=L.readUInt(e,32,4,n);let a=1024;const s=ie.statSync(t).size;r+a>s&&(a=s-r-10);const o=ce.alloc(a),p=ie.openSync(t,"r");return ie.readSync(p,o,0,a,r),ie.closeSync(p),o.slice(2)}function zt(e,t){const n=L.readUInt(e,16,8,t);return(L.readUInt(e,16,10,t)<<16)+n}function Wt(e){if(e.length>24)return e.slice(12)}function Kt(e,t){const n={};let r=e;for(;r&&r.length;){const a=L.readUInt(r,16,0,t),s=L.readUInt(r,16,2,t),o=L.readUInt(r,32,4,t);if(a===0)break;o===1&&(s===3||s===4)&&(n[a]=zt(r,t)),r=Wt(r)}return n}function qt(e){const t=e.toString("ascii",0,2);if(t==="II")return"LE";if(t==="MM")return"BE"}const Xt=["49492a00","4d4d002a"];re.TIFF={validate(e){return Xt.includes(e.toString("hex",0,4))},calculate(e,t){if(!t)throw new TypeError("Tiff doesn't support buffer");const n=qt(e)==="BE",r=Vt(e,t,n),a=Kt(r,n),s=a[256],o=a[257];if(!s||!o)throw new TypeError("Invalid Tiff. Missing tags");return{height:o,width:s}}};var ae={};Object.defineProperty(ae,"__esModule",{value:!0}),ae.WEBP=void 0;function Yt(e){return{height:1+e.readUIntLE(7,3),width:1+e.readUIntLE(4,3)}}function $t(e){return{height:1+((e[4]&15)<<10|e[3]<<2|(e[2]&192)>>6),width:1+((e[2]&63)<<8|e[1])}}function Zt(e){return{height:e.readInt16LE(8)&16383,width:e.readInt16LE(6)&16383}}ae.WEBP={validate(e){const t=e.toString("ascii",0,4)==="RIFF",n=e.toString("ascii",8,12)==="WEBP",r=e.toString("ascii",12,15)==="VP8";return t&&n&&r},calculate(e){const t=e.toString("ascii",12,16);if(e=e.slice(20,30),t==="VP8X"){const r=e[0],a=(r&192)===0,s=(r&1)===0;if(a&&s)return Yt(e);throw new TypeError("Invalid WebP")}if(t==="VP8 "&&e[0]!==47)return Zt(e);const n=e.toString("hex",3,6);if(t==="VP8L"&&n!=="9d012a")return $t(e);throw new TypeError("Invalid WebP")}},Object.defineProperty(M,"__esModule",{value:!0}),M.typeHandlers=void 0;const Qt=G,en=H,tn=J,nn=V,rn=z,an=N,sn=W,on=K,ln=X,cn=Y,dn=$,hn=Z,un=Q,pn=ee,gn=re,fn=ae;M.typeHandlers={bmp:Qt.BMP,cur:en.CUR,dds:tn.DDS,gif:nn.GIF,icns:rn.ICNS,ico:an.ICO,j2c:sn.J2C,jp2:on.JP2,jpg:ln.JPG,ktx:cn.KTX,png:dn.PNG,pnm:hn.PNM,psd:un.PSD,svg:pn.SVG,tiff:gn.TIFF,webp:fn.WEBP};var se={};Object.defineProperty(se,"__esModule",{value:!0}),se.detector=void 0;const me=M,mn=Object.keys(me.typeHandlers),Oe={56:"psd",66:"bmp",68:"dds",71:"gif",73:"tiff",77:"tiff",82:"webp",105:"icns",137:"png",255:"jpg"};function xn(e){const t=e[0];if(t in Oe){const r=Oe[t];if(me.typeHandlers[r].validate(e))return r}const n=r=>me.typeHandlers[r].validate(e);return mn.find(n)}se.detector=xn,function(e,t){var n=ze&&ze.__awaiter||function(y,g,h,f){function P(w){return w instanceof h?w:new h(function(v){v(w)})}return new(h||(h=Promise))(function(w,v){function U(u){try{F(f.next(u))}catch(C){v(C)}}function oe(u){try{F(f.throw(u))}catch(C){v(C)}}function F(u){u.done?w(u.value):P(u.value).then(U,oe)}F((f=f.apply(y,g||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.types=t.setConcurrency=t.imageSize=void 0;const r=Ve,a=Tn,s=ht,o=M,p=se,j=512*1024,m=new s.default({concurrency:100,autostart:!0});function l(y,g){const h=p.detector(y);if(h&&h in o.typeHandlers){const f=o.typeHandlers[h].calculate(y,g);if(f!==void 0)return f.type=h,f}throw new TypeError("unsupported file type: "+h+" (file: "+g+")")}function d(y){return n(this,void 0,void 0,function*(){const g=yield r.promises.open(y,"r"),{size:h}=yield g.stat();if(h<=0)throw yield g.close(),new Error("Empty file");const f=Math.min(h,j),P=ce.alloc(f);return yield g.read(P,0,f,0),yield g.close(),P})}function b(y){const g=r.openSync(y,"r"),{size:h}=r.fstatSync(g);if(h<=0)throw r.closeSync(g),new Error("Empty file");const f=Math.min(h,j),P=ce.alloc(f);return r.readSync(g,P,0,f,0),r.closeSync(g),P}e.exports=t=k,t.default=k;function k(y,g){if(ce.isBuffer(y))return l(y);if(typeof y!="string")throw new TypeError("invalid invocation");const h=a.resolve(y);if(typeof g=="function")m.push(()=>d(h).then(f=>Un.nextTick(g,null,l(f,h))).catch(g));else{const f=b(h);return l(f,h)}}t.imageSize=k,t.setConcurrency=y=>{m.concurrency=y},t.types=Object.keys(o.typeHandlers)}(Ce,Ce.exports);let xe,Fe,Re,ye;xe=e=>e.type.startsWith("image/"),Fe=async({provider:e,account:t})=>{let n=await new Ae(ve.pushToken,Ge.pushToken,e).allowance(t,ve.epnscore);n=n==null?void 0:n.toString();const r=Ln(n);return Number(r)},Re=({view:e,setView:t,setActiveStepKey:n,handleNextStep:r})=>{const a=E.useRef(),{values:s,setFieldValue:o}=de(),p=async l=>{var b;const d=(b=l.currentTarget.files)==null?void 0:b[0];t(!1),d&&xe(d)&&await m(d)},j=async l=>{var b;l.preventDefault(),l.stopPropagation(),t(!1);const d=(b=l.dataTransfer.files)==null?void 0:b[0];d&&xe(d)&&await m(d)},m=async l=>{o("image",l);const d=new FileReader;d.readAsDataURL(l),d.onloadend=()=>{o("imageSrc",d.result),o("imageType",l.type)}};return i.jsxs(c,{display:"flex",flexDirection:"column",gap:"s8",alignItems:"center",alignSelf:"stretch",children:[i.jsxs(c,{display:"flex",flexDirection:"column",alignItems:"center",gap:"s8",children:[i.jsx(x,{variant:"bes-regular",color:"text-tertiary",children:"Upload a PNG, JPG upto 1MB. Crop the image to resize to 128px."}),i.jsx(Dn,{hidden:!0,id:"file-upload",onChange:p,onDrop:j,children:i.jsxs(c,{width:{initial:"500px",ml:"325px"},padding:"spacing-xxl spacing-none",display:"flex",flexDirection:"column",alignItems:"center",border:{light:"1px dashed gray-300",dark:"1px dashed gray-700"},borderRadius:"r6",backgroundColor:"surface-secondary",gap:"s6",children:[s!=null&&s.image?e?i.jsx(c,{width:"128px",height:"128px",borderRadius:"r5",children:i.jsx("img",{style:{borderRadius:"inherit"},width:"100%",height:"100%",src:s.image,alt:"Cropped Img"})}):i.jsx(zn,{width:"200px",height:"200px",imageSrc:s.imageSrc,imageType:s.imageType,onImageCropped:l=>{t(!0),o("image",l)},ref:a}):i.jsx(qe,{size:50}),i.jsxs(c,{display:"flex",gap:"s1",children:[i.jsx(x,{variant:"bs-semibold",color:"text-tertiary",children:" Drag and Drop or"}),i.jsx("label",{htmlFor:"file-upload",children:i.jsx(x,{variant:"bs-semibold",color:"text-brand-medium",css:Je`cursor:pointer;`,children:"Browse to Choose"})})]})]})})]}),(s==null?void 0:s.image)&&(e?i.jsx(i.Fragment,{children:i.jsx(D,{disabled:!e&&!(s!=null&&s.image),onClick:()=>{r("stakeFees"),n("stakeFees")},children:"Next"})}):i.jsx(i.Fragment,{children:i.jsx(D,{onClick:()=>{a.current.showCroppedImage()},children:"Crop Image"})}))]})},ye=Mn(he.toString(),18),Ke=()=>{const{account:e,provider:t,isWalletConnected:n,chainId:r,connect:a}=we(),s=je.coreContractChain===r,{mutate:o}=Wn(),{mutate:p}=Ye(),[j,m]=E.useState("channelInfo"),[l,d]=E.useState(["channelInfo"]),b=u=>{d([...new Set([...l,u])]),m(u)},[k,y]=E.useState(!1),[g,h]=E.useState(A),[f,P]=E.useState(Ie),w=(u,C,S)=>{h(T=>({...T,progress:u,progressInfo:C,processingInfo:S}))},v=(u,C)=>{P(S=>({...S,txErrorStatus:u,txError:C}))},U=(u,C)=>{o({noOfTokenToApprove:ye,signer:u},{onSuccess:S=>{S.status===1&&(w(60,"Please complete the transaction in your wallet to continue.","Approving PUSH"),oe(u,C))},onError:S=>(console.log("Error in approving PUSH Token",S),S.code===4001||S.code==="ACTION_REJECTED"?(console.log("Signature error ",S),v(1,"User Rejected Signature. Please try again.")):v(2,"Transaction failed due to one of the following reasons:"),h(A),!1)})},oe=(u,C)=>{let S=Fn.GENERAL;const T="1+"+C,R=On(T);w(70,"Please complete the transaction in your wallet to continue.","Creating Channel..."),p({channelType:S,identityBytes:R,fees:ye,signer:u},{onSuccess:_=>{_.status===0?v(2,"Transaction failed due to one of the following reasons:"):(w(80,"Please wait while we confirm the transaction..","Transaction Confirmed.."),setTimeout(()=>{w(90,"Creating your channel, Aligning pixels, adjusting padding... This may take some time.","Redirecting... Please do not refresh")},2e3),setTimeout(()=>{w(100,"Creating your channel, Aligning pixels, adjusting padding... This may take some time.","Redirecting... Please do not refresh"),window.location.reload()},3e3))},onError:_=>{console.log("Error in transaction from query >>>>",_),_.code===4001||_.code==="ACTION_REJECTED"?(console.log("Signature error ",_),v(1,"User Rejected Signature. Please try again."),h(A)):(console.error("Error in creating channel--> %o",_),console.error({error:_}),w(0,"There was an error in creating the Channel","Kindly Contact support@epns.io to resolve the issue."))}})},F=async u=>{if(h(A),P(Ie),!n){a();return}w(10,"Checking for PUSH Token Approval","Loading...");const C=await Fe({provider:t,account:e}),S=JSON.stringify({name:u.channelName,info:u.channelDesc,url:u.channelURL,icon:u.image});w(20,"Please wait, payload is getting uploaded to IPFS","Loading...");let T=await Bn(S);console.debug("IPFS storagePointer:",T),w(40,"Please complete the transaction in your wallet to continue.","Payload Uploaded...");var R=t.getSigner(e);console.debug(R),C<50?U(R,T):oe(R,T)};return i.jsx(Ze,{onSubmit:u=>F(u),children:i.jsxs(c,{padding:{initial:"spacing-lg",ml:"spacing-sm"},backgroundColor:"surface-primary",borderRadius:"radius-md",display:"flex",width:{initial:"648px",ml:"325px"},flexDirection:"column",alignItems:"center",gap:"spacing-xl",children:[i.jsx(tt,{}),!s&&i.jsx(rt,{}),s&&i.jsxs(i.Fragment,{children:[f.txErrorStatus!==0&&i.jsx(Nn,{variant:"error",icon:i.jsx(An,{color:"icon-state-danger-bold",size:24}),message:f.txError,width:"100%"}),g.progress?i.jsx(nt,{progressState:g}):i.jsxs(c,{display:"flex",flexDirection:"column",gap:"spacing-lg",alignItems:"center",alignSelf:"stretch",children:[i.jsx(Hn,{steps:et,completedSteps:l,setActiveStepKey:u=>m(u)}),j=="channelInfo"&&i.jsx(Qe,{handleNextStep:b,setActiveStepKey:m}),j==="uploadLogo"&&i.jsx(Re,{view:k,setView:y,setActiveStepKey:m,handleNextStep:b}),j==="stakeFees"&&i.jsx(at,{channelStakeFees:he,handleNextStep:b})]})]})]})})}});export{Ke as C,sr as __tla};
