import{e6 as Z,e7 as B,bi as K,b1 as e,b2 as o,dR as R,dP as G,bY as w,aY as V,a_ as p,bp as u,b$ as q,e8 as H,c$ as F,aZ as J,dq as Q,b0 as W,d2 as z,e9 as X,bq as ee,dU as ae,dV as se,db as ne,__tla as ie}from"./index-DnzKmFxo.js";import{S as te,__tla as re}from"./Stepper-DSxdrWTu.js";import{u as Y,__tla as le}from"./useMutation-CR-caW6v.js";import{g as oe,__tla as ce}from"./Common.utils-DV8MxIGE.js";import{c as de,a as $,u as he,F as ue,b as pe,__tla as ge}from"./index.esm-CwRfMV5R.js";import{i as xe,__tla as me}from"./ValidationHelper-DHPdUFFx.js";import{C as fe,__tla as ye}from"./ContentLayout-W130TEwl.js";let L,be=Promise.all([(()=>{try{return ie}catch{}})(),(()=>{try{return re}catch{}})(),(()=>{try{return le}catch{}})(),(()=>{try{return ce}catch{}})(),(()=>{try{return ge}catch{}})(),(()=>{try{return me}catch{}})(),(()=>{try{return ye}catch{}})()]).then(async()=>{let _,j,I,S,C,v,k,f,A,D,g,T,P,E,M;_=a=>a,j=a=>a,I=({userPushSDKInstance:a,alias:n})=>a.channel.alias.initiate(n).then(_),S=({userPushSDKInstance:a,channelAddress:n})=>a.channel.alias.verify(n).then(j),C=()=>Y({mutationKey:[Z],mutationFn:I}),v=()=>Y({mutationKey:[B],mutationFn:S}),k=[{label:"New Address",value:"newaddress"},{label:"Change Network",value:"changenetwork"},{label:"Verify Alias Chain",value:"verifyalias"}],f=K.allowedNetworks.filter(a=>a!=K.coreContractChain),A=de().shape({alias:$().required("Address is required").test("is-valid-address","Invalid wallet address",xe),chainId:$().required("ChainId is required")}),D=({children:a,onSubmit:n})=>{const t=he({initialValues:{alias:"",chainId:f[0].toString()},validationSchema:A,onSubmit:n});return e.jsx(ue,{value:t,children:a})},g=()=>{const a=pe();if(!a)throw new Error("useChainAliasFormikContext must be used within a FormikChainAliasProvider");return a},T=({isLoading:a})=>{const n=oe(f),{values:t,handleSubmit:c,handleChange:l,errors:i,touched:s}=g();return e.jsx(o,{width:"100%",children:e.jsx("form",{onSubmit:c,children:e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",gap:"spacing-xl",children:[e.jsxs(o,{display:"flex",flexDirection:{ml:"column",dp:"row"},gap:"spacing-xs",alignItems:"flex-start",width:"100%",children:[e.jsx(R,{label:"Your Address on New Chain",description:"Make sure you own this alias as verification will take place.",value:t.alias,onChange:l("alias"),error:(s==null?void 0:s.alias)&&!!(i!=null&&i.alias),errorMessage:s!=null&&s.alias?i==null?void 0:i.alias:""}),e.jsx(o,{display:"flex",alignSelf:"center",width:{dp:"auto",ml:"100%"},margin:"spacing-xxxs spacing-none spacing-none spacing-none",children:e.jsx(G,{options:n,value:t.chainId,onSelect:l("chainId"),error:(s==null?void 0:s.chainId)&&!!(i!=null&&i.chainId),errorMessage:s!=null&&s.chainId?i.chainId:""})})]}),e.jsx(w,{disabled:!t.alias,variant:"primary",loading:a,children:a?"Adding new chain":"Add"})]})})})},P=({handleNextStep:a})=>{const{switchChain:n,chainId:t}=V(),{values:c}=g(),l=parseInt(c.chainId);return p.useEffect(()=>{t===l&&a("verifyalias")},[t]),e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsx(u,{variant:"bs-semibold",color:"text-primary",children:"Switch to the desired chain in your wallet to add it to your channel."}),e.jsx(w,{onClick:()=>n(l),children:"Change Network"})]})},E=()=>{const{userPushSDKInstance:a}=q(h=>h.user),{account:n}=V(),{mutate:t,isPending:c}=v(),{values:l}=g(),i=parseInt(l.chainId),{data:s}=H({alias:n,aliasChain:X[i]}),y=l.alias,x=F(),b=J(),d=()=>{t({userPushSDKInstance:a,channelAddress:(s==null?void 0:s.channel)??""},{onSuccess:()=>{x.showMessageToast({toastTitle:"Success",toastMessage:"Verification Successful",toastType:"SUCCESS",getToastIcon:h=>e.jsx(Q,{size:h,color:"green"})}),b(`${W.ChannelDashboard}/${n}}`)},onError:h=>{h&&x.showMessageToast({toastTitle:"Error",toastMessage:h.message,toastType:"ERROR",getToastIcon:m=>e.jsx(z,{size:m,color:"red"})})}})};return e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-sm",children:[e.jsxs(u,{variant:"bs-semibold",textAlign:"center",color:"text-primary",children:["You\u2019re almost there!",e.jsx("br",{})," Verify the address on the new chain to send notifications."]}),e.jsx(R,{disabled:!0,value:y})]}),e.jsx(w,{onClick:d,loading:c,children:c?"Verifying":"Verify New Address"})]})},M=()=>{const[a,n]=p.useState("newaddress"),[t,c]=p.useState(["newaddress"]),[l,i]=p.useState(!0),s=F(),{mutate:y,isPending:x,isError:b}=C(),{userPushSDKInstance:d}=q(r=>r.user);p.useEffect(()=>{i(d&&(d==null?void 0:d.readmode()))},[d]);const h=(r,O)=>{y({userPushSDKInstance:d,alias:ne(r,parseInt(O))},{onSuccess:()=>{m("changenetwork")},onError:N=>{N&&s.showMessageToast({toastTitle:"Error",toastMessage:N.message,toastType:"ERROR",getToastIcon:U=>e.jsx(z,{size:U,color:"red"})})}})},m=r=>{c([...new Set([...t,r])]),n(r)};return e.jsx(D,{onSubmit:r=>h(r.alias,r.chainId),children:e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",margin:{ml:"spacing-lg spacing-md",dp:"spacing-lg spacing-none spacing-none spacing-none"},padding:{dp:"spacing-lg",ml:"spacing-sm"},gap:"spacing-lg",borderRadius:"radius-lg",backgroundColor:"surface-primary",children:[e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",gap:"spacing-xxxs",children:[e.jsx(u,{color:"text-primary",variant:"h3-semibold",display:{ml:"none",dp:"block"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-primary",variant:"h4-semibold",display:{ml:"block",dp:"none"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-tertiary",variant:"bs-regular",display:{ml:"none",dp:"block"},children:"Add an alias chain to your channel to enable notifications to that chain."}),e.jsx(u,{display:{ml:"block",dp:"none"},color:"text-tertiary",variant:"bes-regular",children:"Add an alias chain to your channel to enable notifications to that chain."})]}),e.jsx(te,{steps:k,completedSteps:t,setActiveStepKey:r=>n(r)}),a==="newaddress"&&e.jsx(T,{isLoading:x&&!b}),a==="changenetwork"&&e.jsx(P,{handleNextStep:m}),a==="verifyalias"&&e.jsx(E,{}),l&&e.jsx(o,{display:"flex",justifyContent:"center",width:"-webkit-fill-available",alignItems:"center",css:ee`
              z-index: 99999;
            `,children:e.jsx(ae,{type:se.MODAL,showConnectModal:!0,onClose:()=>i(!1)})})]})})},L=()=>e.jsx(fe,{children:e.jsx(M,{})})});export{be as __tla,L as default};
