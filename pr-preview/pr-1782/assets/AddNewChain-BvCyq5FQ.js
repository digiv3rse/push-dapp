import{e1 as Z,e2 as $,e3 as B,b1 as e,bi as G,b2 as o,dL as P,dJ as H,bX as f,aY as K,a$ as m,bp as u,b_ as R,c_ as V,aZ as q,dd as F,ds as W,b0 as ee,d1 as z,a_ as ae,bq as se,dP as ne,dQ as ie,__tla as te}from"./index-DM7ZIfOI.js";import{u as L,__tla as re}from"./useMutation-bNQo4QqD.js";import{S as le,__tla as oe}from"./Stepper-BgnDZO76.js";import{g as ce,__tla as de}from"./Common.utils-CqkK53Lk.js";import{c as he,a as O,u as ue,F as pe,b as xe,__tla as ge}from"./index.esm-Bs7nMujD.js";import{C as me,__tla as fe}from"./ContentLayout-Dh4YWVCC.js";let Y,ye=Promise.all([(()=>{try{return te}catch{}})(),(()=>{try{return re}catch{}})(),(()=>{try{return oe}catch{}})(),(()=>{try{return de}catch{}})(),(()=>{try{return ge}catch{}})(),(()=>{try{return fe}catch{}})()]).then(async()=>{let y,b,w,j,_,I,S,v,C,k,p,A,D,T,E;y=a=>a,b=a=>a,w=({userPushSDKInstance:a,alias:n})=>a.channel.alias.initiate(n).then(y),j=({userPushSDKInstance:a,alias:n})=>a.channel.alias.verify(n).then(b),_=()=>L({mutationKey:[Z],mutationFn:w}),I=()=>L({mutationKey:[$],mutationFn:j}),S=[{label:"New Address",value:"newaddress"},{label:"Change Network",value:"changenetwork"},{label:"Verify Alias Chain",value:"verifyalias"}],v=a=>B(a),C=he().shape({alias:O().required("Address is required").test("is-valid-address","Invalid wallet address",v),chainId:O().required("ChainId is required")}),k=({children:a,onSubmit:n})=>{const i=ue({initialValues:{alias:"",chainId:"11155111"},validationSchema:C,onSubmit:n});return e.jsx(pe,{value:i,children:a})},p=()=>{const a=xe();if(!a)throw new Error("useChainAliasFormikContext must be used within a FormikChainAliasProvider");return a},A=({isLoading:a})=>{const n=ce(G.allowedNetworks),{values:i,handleSubmit:c,handleChange:l,errors:t,touched:s}=p();return e.jsx(o,{width:"100%",children:e.jsx("form",{onSubmit:c,children:e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",gap:"spacing-xl",children:[e.jsxs(o,{display:"flex",flexDirection:{ml:"column",dp:"row"},gap:"spacing-xs",alignItems:"flex-start",width:"100%",children:[e.jsx(P,{label:"Your Address on New Chain",description:"Make sure you own this alias as verification will take place.",value:i.alias,onChange:l("alias"),error:(s==null?void 0:s.alias)&&!!(t!=null&&t.alias),errorMessage:s!=null&&s.alias?t==null?void 0:t.alias:""}),e.jsx(o,{display:"flex",alignSelf:"center",width:{dp:"auto",ml:"100%"},margin:"spacing-xxxs spacing-none spacing-none spacing-none",children:e.jsx(H,{options:n,value:i.chainId,onSelect:l("chainId"),error:(s==null?void 0:s.chainId)&&!!(t!=null&&t.chainId),errorMessage:s!=null&&s.chainId?t.chainId:""})})]}),e.jsx(f,{disabled:!i.alias||a,variant:"primary",children:a?"Initiating":"Add"})]})})})},D=({handleNextStep:a})=>{const{switchChain:n,chainId:i}=K(),{values:c}=p(),l=parseInt(c.chainId);return m.useEffect(()=>{i===l&&a("verifyalias")},[i]),e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsx(u,{variant:"bs-semibold",color:"text-primary",children:"Switch to the desired chain in your wallet to add it to your channel."}),e.jsx(f,{onClick:()=>n(l),children:"Change Network"})]})},T=()=>{const{userPushSDKInstance:a}=R(d=>d.user),{mutate:n,isPending:i}=I(),{values:c}=p(),l=V(),t=q(),s=parseInt(c.chainId),x=c.alias,h=()=>{n({userPushSDKInstance:a,alias:F(x,s)},{onSuccess:()=>{l.showMessageToast({toastTitle:"Success",toastMessage:"Verification Successful",toastType:"SUCCESS",getToastIcon:d=>e.jsx(W,{size:d,color:"green"})}),t(ee.Dashboard)},onError:d=>{d&&l.showMessageToast({toastTitle:"Error",toastMessage:d.message,toastType:"ERROR",getToastIcon:g=>e.jsx(z,{size:g,color:"red"})})}})};return e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-sm",children:[e.jsxs(u,{variant:"bs-semibold",textAlign:"center",color:"text-primary",children:["You\u2019re almost there!",e.jsx("br",{})," Verify the address on the new chain to send notifications."]}),e.jsx(P,{disabled:!0,value:x})]}),e.jsx(f,{onClick:h,disabled:i,children:i?"Verifying":"Verify New Address"})]})},E=()=>{const[a,n]=m.useState("newaddress"),[i,c]=m.useState(["newaddress"]),l=V(),{mutate:t,isPending:s,isError:x}=_(),{userPushSDKInstance:h}=R(r=>r.user),{account:d}=K(),{data:g}=ae(d),J=q();m.useEffect(()=>{g||J("/channels")},[g]);const Q=(r,U)=>{t({userPushSDKInstance:h,alias:F(r,parseInt(U))},{onSuccess:()=>{M("changenetwork")},onError:N=>{N&&l.showMessageToast({toastTitle:"Error",toastMessage:N.message,toastType:"ERROR",getToastIcon:X=>e.jsx(z,{size:X,color:"red"})})}})},M=r=>{c([...new Set([...i,r])]),n(r)};return e.jsx(k,{onSubmit:r=>Q(r.alias,r.chainId),children:e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",margin:{ml:"spacing-lg spacing-md",dp:"spacing-lg spacing-none spacing-none spacing-none"},padding:{dp:"spacing-lg",ml:"spacing-sm"},gap:"spacing-lg",borderRadius:"radius-lg",backgroundColor:"surface-primary",children:[e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",gap:"spacing-xxxs",children:[e.jsx(u,{color:"text-primary",variant:"h3-semibold",display:{ml:"none",dp:"block"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-primary",variant:"h4-semibold",display:{ml:"block",dp:"none"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-tertiary",variant:"bs-regular",display:{ml:"none",dp:"block"},children:"Add an alias chain to your channel to enable notifications to that chain."}),e.jsx(u,{display:{ml:"block",dp:"none"},color:"text-tertiary",variant:"bes-regular",children:"Add an alias chain to your channel to enable notifications to that chain."})]}),e.jsx(le,{steps:S,completedSteps:i,setActiveStepKey:r=>n(r)}),a==="newaddress"&&e.jsx(A,{isLoading:s&&!x}),a==="changenetwork"&&e.jsx(D,{handleNextStep:M}),a==="verifyalias"&&e.jsx(T,{}),h&&(h==null?void 0:h.readmode())&&e.jsx(o,{display:"flex",justifyContent:"center",width:"-webkit-fill-available",alignItems:"center",css:se`
              z-index: 99999;
            `,children:e.jsx(ne,{type:ie.MODAL,showConnectModal:!0})})]})})},Y=()=>e.jsx(me,{children:e.jsx(E,{})})});export{ye as __tla,Y as default};
