import{e5 as B,e6 as G,bi as P,b1 as e,b2 as l,dQ as R,dO as H,bY as y,aY as b,a_ as p,bp as u,b$ as q,c$ as F,aZ as V,dq as J,b0 as W,d2 as $,a$ as X,bq as ee,dT as ae,dU as se,db as ne,__tla as ie}from"./index-CllG0K_R.js";import{u as z,__tla as te}from"./useMutation-CEuFyY_K.js";import{S as re,__tla as le}from"./Stepper-A-NHBw2Y.js";import{g as oe,__tla as ce}from"./Common.utils-DjOXlLxC.js";import{c as de,a as O,u as he,F as ue,b as pe,__tla as ge}from"./index.esm-mBjoZMzs.js";import{i as xe,__tla as me}from"./ValidationHelper-Dp-SMtg8.js";import{C as fe,__tla as ye}from"./ContentLayout-DewAj-6n.js";let Y,be=Promise.all([(()=>{try{return ie}catch{}})(),(()=>{try{return te}catch{}})(),(()=>{try{return le}catch{}})(),(()=>{try{return ce}catch{}})(),(()=>{try{return ge}catch{}})(),(()=>{try{return me}catch{}})(),(()=>{try{return ye}catch{}})()]).then(async()=>{let w,_,j,S,I,v,C,x,k,A,g,D,T,E,M;w=a=>a,_=a=>a,j=({userPushSDKInstance:a,alias:i})=>a.channel.alias.initiate(i).then(w),S=({userPushSDKInstance:a,channelAddress:i})=>a.channel.alias.verify(i).then(_),I=()=>z({mutationKey:[B],mutationFn:j}),v=()=>z({mutationKey:[G],mutationFn:S}),C=[{label:"New Address",value:"newaddress"},{label:"Change Network",value:"changenetwork"},{label:"Verify Alias Chain",value:"verifyalias"}],x=P.allowedNetworks.filter(a=>a!=P.coreContractChain),k=de().shape({alias:O().required("Address is required").test("is-valid-address","Invalid wallet address",xe),chainId:O().required("ChainId is required")}),A=({children:a,onSubmit:i})=>{const t=he({initialValues:{alias:"",chainId:x[0].toString()},validationSchema:k,onSubmit:i});return e.jsx(ue,{value:t,children:a})},g=()=>{const a=pe();if(!a)throw new Error("useChainAliasFormikContext must be used within a FormikChainAliasProvider");return a},D=({isLoading:a})=>{const i=oe(x),{values:t,handleSubmit:c,handleChange:o,errors:s,touched:n}=g();return e.jsx(l,{width:"100%",children:e.jsx("form",{onSubmit:c,children:e.jsxs(l,{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",gap:"spacing-xl",children:[e.jsxs(l,{display:"flex",flexDirection:{ml:"column",dp:"row"},gap:"spacing-xs",alignItems:"flex-start",width:"100%",children:[e.jsx(R,{label:"Your Address on New Chain",description:"Make sure you own this alias as verification will take place.",value:t.alias,onChange:o("alias"),error:(n==null?void 0:n.alias)&&!!(s!=null&&s.alias),errorMessage:n!=null&&n.alias?s==null?void 0:s.alias:""}),e.jsx(l,{display:"flex",alignSelf:"center",width:{dp:"auto",ml:"100%"},margin:"spacing-xxxs spacing-none spacing-none spacing-none",children:e.jsx(H,{options:i,value:t.chainId,onSelect:o("chainId"),error:(n==null?void 0:n.chainId)&&!!(s!=null&&s.chainId),errorMessage:n!=null&&n.chainId?s.chainId:""})})]}),e.jsx(y,{disabled:!t.alias,variant:"primary",loading:a,children:a?"Adding new chain":"Add"})]})})})},T=({handleNextStep:a})=>{const{switchChain:i,chainId:t}=b(),{values:c}=g(),o=parseInt(c.chainId);return p.useEffect(()=>{t===o&&a("verifyalias")},[t]),e.jsxs(l,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsx(u,{variant:"bs-semibold",color:"text-primary",children:"Switch to the desired chain in your wallet to add it to your channel."}),e.jsx(y,{onClick:()=>i(o),children:"Change Network"})]})},E=()=>{const{userPushSDKInstance:a}=q(d=>d.user),{account:i}=b(),{mutate:t,isPending:c}=v(),{values:o}=g(),s=F(),n=V(),m=o.alias,f=()=>{t({userPushSDKInstance:a,channelAddress:i},{onSuccess:()=>{s.showMessageToast({toastTitle:"Success",toastMessage:"Verification Successful",toastType:"SUCCESS",getToastIcon:d=>e.jsx(J,{size:d,color:"green"})}),n(`${W.ChannelDashboard}/${i}}`)},onError:d=>{d&&s.showMessageToast({toastTitle:"Error",toastMessage:d.message,toastType:"ERROR",getToastIcon:h=>e.jsx($,{size:h,color:"red"})})}})};return e.jsxs(l,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsxs(l,{display:"flex",flexDirection:"column",gap:"spacing-sm",children:[e.jsxs(u,{variant:"bs-semibold",textAlign:"center",color:"text-primary",children:["You\u2019re almost there!",e.jsx("br",{})," Verify the address on the new chain to send notifications."]}),e.jsx(R,{disabled:!0,value:m})]}),e.jsx(y,{onClick:f,loading:c,children:c?"Verifying":"Verify New Address"})]})},M=()=>{const[a,i]=p.useState("newaddress"),[t,c]=p.useState(["newaddress"]),[o,s]=p.useState(!0),n=F(),{mutate:m,isPending:f,isError:d}=I(),{userPushSDKInstance:h}=q(r=>r.user),{account:L}=b();X(L),V(),p.useEffect(()=>{s(h&&(h==null?void 0:h.readmode()))},[h]);const U=(r,Q)=>{m({userPushSDKInstance:h,alias:ne(r,parseInt(Q))},{onSuccess:()=>{N("changenetwork")},onError:K=>{K&&n.showMessageToast({toastTitle:"Error",toastMessage:K.message,toastType:"ERROR",getToastIcon:Z=>e.jsx($,{size:Z,color:"red"})})}})},N=r=>{c([...new Set([...t,r])]),i(r)};return e.jsx(A,{onSubmit:r=>U(r.alias,r.chainId),children:e.jsxs(l,{display:"flex",flexDirection:"column",alignItems:"center",margin:{ml:"spacing-lg spacing-md",dp:"spacing-lg spacing-none spacing-none spacing-none"},padding:{dp:"spacing-lg",ml:"spacing-sm"},gap:"spacing-lg",borderRadius:"radius-lg",backgroundColor:"surface-primary",children:[e.jsxs(l,{display:"flex",flexDirection:"column",alignItems:"center",gap:"spacing-xxxs",children:[e.jsx(u,{color:"text-primary",variant:"h3-semibold",display:{ml:"none",dp:"block"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-primary",variant:"h4-semibold",display:{ml:"block",dp:"none"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-tertiary",variant:"bs-regular",display:{ml:"none",dp:"block"},children:"Add an alias chain to your channel to enable notifications to that chain."}),e.jsx(u,{display:{ml:"block",dp:"none"},color:"text-tertiary",variant:"bes-regular",children:"Add an alias chain to your channel to enable notifications to that chain."})]}),e.jsx(re,{steps:C,completedSteps:t,setActiveStepKey:r=>i(r)}),a==="newaddress"&&e.jsx(D,{isLoading:f&&!d}),a==="changenetwork"&&e.jsx(T,{handleNextStep:N}),a==="verifyalias"&&e.jsx(E,{}),o&&e.jsx(l,{display:"flex",justifyContent:"center",width:"-webkit-fill-available",alignItems:"center",css:ee`
              z-index: 99999;
            `,children:e.jsx(ae,{type:se.MODAL,showConnectModal:!0,onClose:()=>s(!1)})})]})})},Y=()=>e.jsx(fe,{children:e.jsx(M,{})})});export{be as __tla,Y as default};
