import{e0 as B,e1 as G,b1 as a,bi as H,b2 as o,dK as M,dI as J,bY as f,aY as N,a$ as m,bq as u,b$ as P,d0 as R,aZ as V,dc as q,dr as Q,b0 as W,d3 as F,a_ as X,br as aa,dO as ea,dP as sa,__tla as ia}from"./index-DogFBbdN.js";import{u as z,__tla as na}from"./useMutation-v9wsiPGa.js";import{S as ta,__tla as ra}from"./Stepper-BSOe384_.js";import{g as la,__tla as oa}from"./Common.utils-Ctjv3Qcx.js";import{c as ca,a as O,u as da,F as ha,b as ua,__tla as pa}from"./index.esm-CCZhOUTw.js";import{i as xa,__tla as ga}from"./ValidationHelper-h8HVh4Ww.js";import{C as ma,__tla as fa}from"./ContentLayout-DUZEpIDj.js";let Y,ya=Promise.all([(()=>{try{return ia}catch{}})(),(()=>{try{return na}catch{}})(),(()=>{try{return ra}catch{}})(),(()=>{try{return oa}catch{}})(),(()=>{try{return pa}catch{}})(),(()=>{try{return ga}catch{}})(),(()=>{try{return fa}catch{}})()]).then(async()=>{let y,b,w,_,j,I,S,v,C,p,k,A,D,T;y=e=>e,b=e=>e,w=({userPushSDKInstance:e,alias:i})=>e.channel.alias.initiate(i).then(y),_=({userPushSDKInstance:e,alias:i})=>e.channel.alias.verify(i).then(b),j=()=>z({mutationKey:[B],mutationFn:w}),I=()=>z({mutationKey:[G],mutationFn:_}),S=[{label:"New Address",value:"newaddress"},{label:"Change Network",value:"changenetwork"},{label:"Verify Alias Chain",value:"verifyalias"}],v=ca().shape({alias:O().required("Address is required").test("is-valid-address","Invalid wallet address",xa),chainId:O().required("ChainId is required")}),C=({children:e,onSubmit:i})=>{const n=da({initialValues:{alias:"",chainId:"11155111"},validationSchema:v,onSubmit:i});return a.jsx(ha,{value:n,children:e})},p=()=>{const e=ua();if(!e)throw new Error("useChainAliasFormikContext must be used within a FormikChainAliasProvider");return e},k=({isLoading:e})=>{const i=la(H.allowedNetworks),{values:n,handleSubmit:c,handleChange:l,errors:t,touched:s}=p();return a.jsx(o,{width:"100%",children:a.jsx("form",{onSubmit:c,children:a.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",gap:"spacing-xl",children:[a.jsxs(o,{display:"flex",flexDirection:{ml:"column",dp:"row"},gap:"spacing-xs",alignItems:"flex-start",width:"100%",children:[a.jsx(M,{label:"Your Address on New Chain",description:"Make sure you own this alias as verification will take place.",value:n.alias,onChange:l("alias"),error:(s==null?void 0:s.alias)&&!!(t!=null&&t.alias),errorMessage:s!=null&&s.alias?t==null?void 0:t.alias:""}),a.jsx(o,{display:"flex",alignSelf:"center",width:{dp:"auto",ml:"100%"},margin:"spacing-xxxs spacing-none spacing-none spacing-none",children:a.jsx(J,{options:i,value:n.chainId,onSelect:l("chainId"),error:(s==null?void 0:s.chainId)&&!!(t!=null&&t.chainId),errorMessage:s!=null&&s.chainId?t.chainId:""})})]}),a.jsx(f,{disabled:!n.alias||e,variant:"primary",children:e?"Initiating":"Add"})]})})})},A=({handleNextStep:e})=>{const{switchChain:i,chainId:n}=N(),{values:c}=p(),l=parseInt(c.chainId);return m.useEffect(()=>{n===l&&e("verifyalias")},[n]),a.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[a.jsx(u,{variant:"bs-semibold",color:"text-primary",children:"Switch to the desired chain in your wallet to add it to your channel."}),a.jsx(f,{onClick:()=>i(l),children:"Change Network"})]})},D=()=>{const{userPushSDKInstance:e}=P(d=>d.user),{mutate:i,isPending:n}=I(),{values:c}=p(),l=R(),t=V(),s=parseInt(c.chainId),x=c.alias,h=()=>{i({userPushSDKInstance:e,alias:q(x,s)},{onSuccess:()=>{l.showMessageToast({toastTitle:"Success",toastMessage:"Verification Successful",toastType:"SUCCESS",getToastIcon:d=>a.jsx(Q,{size:d,color:"green"})}),t(W.Dashboard)},onError:d=>{d&&l.showMessageToast({toastTitle:"Error",toastMessage:d.message,toastType:"ERROR",getToastIcon:g=>a.jsx(F,{size:g,color:"red"})})}})};return a.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[a.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-sm",children:[a.jsxs(u,{variant:"bs-semibold",textAlign:"center",color:"text-primary",children:["You\u2019re almost there!",a.jsx("br",{})," Verify the address on the new chain to send notifications."]}),a.jsx(M,{disabled:!0,value:x})]}),a.jsx(f,{onClick:h,disabled:n,children:n?"Verifying":"Verify New Address"})]})},T=()=>{const[e,i]=m.useState("newaddress"),[n,c]=m.useState(["newaddress"]),l=R(),{mutate:t,isPending:s,isError:x}=j(),{userPushSDKInstance:h}=P(r=>r.user),{account:d}=N(),{data:g}=X(d),L=V();m.useEffect(()=>{g||L("/channels")},[g]);const $=(r,U)=>{t({userPushSDKInstance:h,alias:q(r,parseInt(U))},{onSuccess:()=>{E("changenetwork")},onError:K=>{K&&l.showMessageToast({toastTitle:"Error",toastMessage:K.message,toastType:"ERROR",getToastIcon:Z=>a.jsx(F,{size:Z,color:"red"})})}})},E=r=>{c([...new Set([...n,r])]),i(r)};return a.jsx(C,{onSubmit:r=>$(r.alias,r.chainId),children:a.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",margin:{ml:"spacing-lg spacing-md",dp:"spacing-lg spacing-none spacing-none spacing-none"},padding:{dp:"spacing-lg",ml:"spacing-sm"},gap:"spacing-lg",borderRadius:"radius-lg",backgroundColor:"surface-primary",children:[a.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",gap:"spacing-xxxs",children:[a.jsx(u,{color:"text-primary",variant:"h3-semibold",display:{ml:"none",dp:"block"},children:"Add New Chain to Channel"}),a.jsx(u,{color:"text-primary",variant:"h4-semibold",display:{ml:"block",dp:"none"},children:"Add New Chain to Channel"}),a.jsx(u,{color:"text-tertiary",variant:"bs-regular",display:{ml:"none",dp:"block"},children:"Add an alias chain to your channel to enable notifications to that chain."}),a.jsx(u,{display:{ml:"block",dp:"none"},color:"text-tertiary",variant:"bes-regular",children:"Add an alias chain to your channel to enable notifications to that chain."})]}),a.jsx(ta,{steps:S,completedSteps:n,setActiveStepKey:r=>i(r)}),e==="newaddress"&&a.jsx(k,{isLoading:s&&!x}),e==="changenetwork"&&a.jsx(A,{handleNextStep:E}),e==="verifyalias"&&a.jsx(D,{}),h&&(h==null?void 0:h.readmode())&&a.jsx(o,{display:"flex",justifyContent:"center",width:"-webkit-fill-available",alignItems:"center",css:aa`
              z-index: 99999;
            `,children:a.jsx(ea,{type:sa.MODAL,showConnectModal:!0})})]})})},Y=()=>a.jsx(ma,{children:a.jsx(T,{})})});export{ya as __tla,Y as default};
