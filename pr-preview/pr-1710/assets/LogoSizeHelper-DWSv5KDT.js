import{r as q,s as le,gJ as xt,m as Gt,gK as nn,q as an,gL as on,gM as sn,dU as nt,gN as ge,dI as de,gO as An,gP as cn,__tla as hn}from"./index-C03HJSIT.js";let pe,me,Ie,we,un=Promise.all([(()=>{try{return hn}catch{}})()]).then(async()=>{we=t=>{const[e,r]=q.useState(!1),[n,u]=q.useState(null),f=q.useCallback(async(o,...s)=>{r(!0);try{const h=await o(...s);return r(!1),h}catch(h){throw r(!1),u(h),h}},[]),a=q.useCallback(async(...o)=>{try{return await f(t,...o)}catch(s){throw console.error(s),s}},[t,f]);return{loading:e,error:n,executeAsyncFunction:a}};var Ht={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function(){function r(n,u,f){function a(h,c){if(!u[h]){if(!n[h]){var i=typeof xt=="function"&&xt;if(!c&&i)return i(h,!0);if(o)return o(h,!0);var I=new Error("Cannot find module '"+h+"'");throw I.code="MODULE_NOT_FOUND",I}var A=u[h]={exports:{}};n[h][0].call(A.exports,function(l){var d=n[h][1][l];return a(d||l)},A,A.exports,r,n,u,f)}return u[h].exports}for(var o=typeof xt=="function"&&xt,s=0;s<f.length;s++)a(f[s]);return a}return r}()({1:[function(r,n,u){var f=r("multimath"),a=r("./mm_unsharp_mask"),o=r("./mm_resize");function s(h){var c=h||[],i={js:c.indexOf("js")>=0,wasm:c.indexOf("wasm")>=0};f.call(this,i),this.features={js:i.js,wasm:i.wasm&&this.has_wasm()},this.use(a),this.use(o)}s.prototype=Object.create(f.prototype),s.prototype.constructor=s,s.prototype.resizeAndUnsharp=function(h,c){var i=this.resize(h,c);return h.unsharpAmount&&this.unsharp_mask(i,h.toWidth,h.toHeight,h.unsharpAmount,h.unsharpRadius,h.unsharpThreshold),i},n.exports=s},{"./mm_resize":4,"./mm_unsharp_mask":9,multimath:19}],2:[function(r,n,u){function f(i){return i<0?0:i>255?255:i}function a(i){return i>=0?i:0}function o(i,I,A,l,d,p){var m,E,C,_,x,U,b,B,M,D,j,S=0,P=0;for(M=0;M<l;M++){for(x=0,D=0;D<d;D++){for(U=p[x++],b=p[x++],B=S+U*4|0,m=E=C=_=0;b>0;b--)j=p[x++],_=_+j*i[B+3]|0,C=C+j*i[B+2]|0,E=E+j*i[B+1]|0,m=m+j*i[B]|0,B=B+4|0;I[P+3]=a(_>>7),I[P+2]=a(C>>7),I[P+1]=a(E>>7),I[P]=a(m>>7),P=P+l*4|0}P=(M+1)*4|0,S=(M+1)*A*4|0}}function s(i,I,A,l,d,p){var m,E,C,_,x,U,b,B,M,D,j,S=0,P=0;for(M=0;M<l;M++){for(x=0,D=0;D<d;D++){for(U=p[x++],b=p[x++],B=S+U*4|0,m=E=C=_=0;b>0;b--)j=p[x++],_=_+j*i[B+3]|0,C=C+j*i[B+2]|0,E=E+j*i[B+1]|0,m=m+j*i[B]|0,B=B+4|0;m>>=7,E>>=7,C>>=7,_>>=7,I[P+3]=f(_+8192>>14),I[P+2]=f(C+8192>>14),I[P+1]=f(E+8192>>14),I[P]=f(m+8192>>14),P=P+l*4|0}P=(M+1)*4|0,S=(M+1)*A*4|0}}function h(i,I,A,l,d,p){var m,E,C,_,x,U,b,B,M,D,j,S,P=0,H=0;for(D=0;D<l;D++){for(U=0,j=0;j<d;j++){for(b=p[U++],B=p[U++],M=P+b*4|0,m=E=C=_=0;B>0;B--)S=p[U++],x=i[M+3],_=_+S*x|0,C=C+S*i[M+2]*x|0,E=E+S*i[M+1]*x|0,m=m+S*i[M]*x|0,M=M+4|0;C=C/255|0,E=E/255|0,m=m/255|0,I[H+3]=a(_>>7),I[H+2]=a(C>>7),I[H+1]=a(E>>7),I[H]=a(m>>7),H=H+l*4|0}H=(D+1)*4|0,P=(D+1)*A*4|0}}function c(i,I,A,l,d,p){var m,E,C,_,x,U,b,B,M,D,j,S=0,P=0;for(M=0;M<l;M++){for(x=0,D=0;D<d;D++){for(U=p[x++],b=p[x++],B=S+U*4|0,m=E=C=_=0;b>0;b--)j=p[x++],_=_+j*i[B+3]|0,C=C+j*i[B+2]|0,E=E+j*i[B+1]|0,m=m+j*i[B]|0,B=B+4|0;m>>=7,E>>=7,C>>=7,_>>=7,_=f(_+8192>>14),_>0&&(m=m*255/_|0,E=E*255/_|0,C=C*255/_|0),I[P+3]=_,I[P+2]=f(C+8192>>14),I[P+1]=f(E+8192>>14),I[P]=f(m+8192>>14),P=P+l*4|0}P=(M+1)*4|0,S=(M+1)*A*4|0}}n.exports={convolveHor:o,convolveVert:s,convolveHorWithPre:h,convolveVertWithPre:c}},{}],3:[function(r,n,u){n.exports="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"},{}],4:[function(r,n,u){n.exports={name:"resize",fn:r("./resize"),wasm_fn:r("./resize_wasm"),wasm_src:r("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(r,n,u){var f=r("./resize_filter_gen"),a=r("./convolve"),o=a.convolveHor,s=a.convolveVert,h=a.convolveHorWithPre,c=a.convolveVertWithPre;function i(A,l,d){for(var p=3,m=l*d*4|0;p<m;){if(A[p]!==255)return!0;p=p+4|0}return!1}function I(A,l,d){for(var p=3,m=l*d*4|0;p<m;)A[p]=255,p=p+4|0}n.exports=function(A){var l=A.src,d=A.width,p=A.height,m=A.toWidth,E=A.toHeight,C=A.scaleX||A.toWidth/A.width,_=A.scaleY||A.toHeight/A.height,x=A.offsetX||0,U=A.offsetY||0,b=A.dest||new Uint8Array(m*E*4),B=typeof A.filter>"u"?"mks2013":A.filter,M=f(B,d,m,C,x),D=f(B,p,E,_,U),j=new Uint16Array(m*p*4);return i(l,d,p)?(h(l,j,d,p,m,M),c(j,b,p,m,E,D)):(o(l,j,d,p,m,M),s(j,b,p,m,E,D),I(b,m,E)),b}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(r,n,u){var f=r("./resize_filter_info"),a=14;function o(s){return Math.round(s*((1<<a)-1))}n.exports=function(s,h,c,i,I){var A=f.filter[s].fn,l=1/i,d=Math.min(1,i),p=f.filter[s].win/d,m,E,C,_,x,U,b,B,M,D,j,S,P,H,R,g,y,w=Math.floor((p+1)*2),Q=new Int16Array((w+2)*c),v=0,O=!Q.subarray||!Q.set;for(m=0;m<c;m++){for(E=(m+.5)*l+I,C=Math.max(0,Math.floor(E-p)),_=Math.min(h-1,Math.ceil(E+p)),x=_-C+1,U=new Float32Array(x),b=new Int16Array(x),B=0,M=C,D=0;M<=_;M++,D++)j=A((M+.5-E)*d),B+=j,U[D]=j;for(S=0,D=0;D<U.length;D++)P=U[D]/B,S+=P,b[D]=o(P);for(b[c>>1]+=o(1-S),H=0;H<b.length&&b[H]===0;)H++;if(H<b.length){for(R=b.length-1;R>0&&b[R]===0;)R--;if(g=C+H,y=R-H+1,Q[v++]=g,Q[v++]=y,!O)Q.set(b.subarray(H,R+1),v),v+=y;else for(D=H;D<=R;D++)Q[v++]=b[D]}else Q[v++]=0,Q[v++]=0}return Q}},{"./resize_filter_info":7}],7:[function(r,n,u){var f={box:{win:.5,fn:function(a){return a<0&&(a=-a),a<.5?1:0}},hamming:{win:1,fn:function(a){if(a<0&&(a=-a),a>=1)return 0;if(a<11920929e-14)return 1;var o=a*Math.PI;return Math.sin(o)/o*(.54+.46*Math.cos(o/1))}},lanczos2:{win:2,fn:function(a){if(a<0&&(a=-a),a>=2)return 0;if(a<11920929e-14)return 1;var o=a*Math.PI;return Math.sin(o)/o*Math.sin(o/2)/(o/2)}},lanczos3:{win:3,fn:function(a){if(a<0&&(a=-a),a>=3)return 0;if(a<11920929e-14)return 1;var o=a*Math.PI;return Math.sin(o)/o*Math.sin(o/3)/(o/3)}},mks2013:{win:2.5,fn:function(a){return a<0&&(a=-a),a>=2.5?0:a>=1.5?-.125*(a-2.5)*(a-2.5):a>=.5?.25*(4*a*a-11*a+7):1.0625-1.75*a*a}}};n.exports={filter:f,f2q:{box:0,hamming:1,lanczos2:2,lanczos3:3},q2f:["box","hamming","lanczos2","lanczos3"]}},{}],8:[function(r,n,u){var f=r("./resize_filter_gen");function a(i,I,A){for(var l=3,d=I*A*4|0;l<d;){if(i[l]!==255)return!0;l=l+4|0}return!1}function o(i,I,A){for(var l=3,d=I*A*4|0;l<d;)i[l]=255,l=l+4|0}function s(i){return new Uint8Array(i.buffer,0,i.byteLength)}var h=!0;try{h=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1}catch{}function c(i,I,A){if(h){I.set(s(i),A);return}for(var l=A,d=0;d<i.length;d++){var p=i[d];I[l++]=p&255,I[l++]=p>>8&255}}n.exports=function(i){var I=i.src,A=i.width,l=i.height,d=i.toWidth,p=i.toHeight,m=i.scaleX||i.toWidth/i.width,E=i.scaleY||i.toHeight/i.height,C=i.offsetX||0,_=i.offsetY||0,x=i.dest||new Uint8Array(d*p*4),U=typeof i.filter>"u"?"mks2013":i.filter,b=f(U,A,d,m,C),B=f(U,l,p,E,_),M=0,D=Math.max(I.byteLength,x.byteLength),j=this.__align(M+D),S=l*d*4*2,P=this.__align(j+S),H=this.__align(P+b.byteLength),R=H+B.byteLength,g=this.__instance("resize",R),y=new Uint8Array(this.__memory.buffer),w=new Uint32Array(this.__memory.buffer),Q=new Uint32Array(I.buffer);w.set(Q),c(b,y,P),c(B,y,H);var v=g.exports.convolveHV||g.exports._convolveHV;a(I,A,l)?v(P,H,j,A,l,d,p,1):(v(P,H,j,A,l,d,p,0),o(x,d,p));var O=new Uint32Array(x.buffer);return O.set(new Uint32Array(this.__memory.buffer,0,p*d)),x}},{"./resize_filter_gen":6}],9:[function(r,n,u){n.exports={name:"unsharp_mask",fn:r("./unsharp_mask"),wasm_fn:r("./unsharp_mask_wasm"),wasm_src:r("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":10,"./unsharp_mask_wasm":11,"./unsharp_mask_wasm_base64":12}],10:[function(r,n,u){var f=r("glur/mono16");function a(o,s,h){for(var c=s*h,i=new Uint16Array(c),I,A,l,d,p=0;p<c;p++)I=o[4*p],A=o[4*p+1],l=o[4*p+2],d=I>=A&&I>=l?I:A>=l&&A>=I?A:l,i[p]=d<<8;return i}n.exports=function(o,s,h,c,i,I){var A,l,d,p,m;if(!(c===0||i<.5)){i>2&&(i=2);var E=a(o,s,h),C=new Uint16Array(E);f(C,s,h,i);for(var _=c/100*4096+.5|0,x=I<<8,U=s*h,b=0;b<U;b++)A=E[b],p=A-C[b],Math.abs(p)>=x&&(l=A+(_*p+2048>>12),l=l>65280?65280:l,l=l<0?0:l,A=A!==0?A:1,d=(l<<12)/A|0,m=b*4,o[m]=o[m]*d+2048>>12,o[m+1]=o[m+1]*d+2048>>12,o[m+2]=o[m+2]*d+2048>>12)}}},{"glur/mono16":18}],11:[function(r,n,u){n.exports=function(f,a,o,s,h,c){if(!(s===0||h<.5)){h>2&&(h=2);var i=a*o,I=i*4,A=i*2,l=i*2,d=Math.max(a,o)*4,p=8*4,m=0,E=I,C=E+A,_=C+l,x=_+l,U=x+d,b=this.__instance("unsharp_mask",I+A+l*2+d+p,{exp:Math.exp}),B=new Uint32Array(f.buffer),M=new Uint32Array(this.__memory.buffer);M.set(B);var D=b.exports.hsv_v16||b.exports._hsv_v16;D(m,E,a,o),D=b.exports.blurMono16||b.exports._blurMono16,D(E,C,_,x,U,a,o,h),D=b.exports.unsharp||b.exports._unsharp,D(m,m,E,C,a,o,s,c),B.set(new Uint32Array(this.__memory.buffer,0,i))}}},{}],12:[function(r,n,u){n.exports="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"},{}],13:[function(r,n,u){var f=100;function a(o,s){this.create=o,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=s||2e3}a.prototype.acquire=function(){var o=this,s;return this.available.length!==0?s=this.available.pop():(s=this.create(),s.id=this.lastId++,s.release=function(){return o.release(s)}),this.acquired[s.id]=s,s},a.prototype.release=function(o){var s=this;delete this.acquired[o.id],o.lastUsed=Date.now(),this.available.push(o),this.timeoutId===0&&(this.timeoutId=setTimeout(function(){return s.gc()},f))},a.prototype.gc=function(){var o=this,s=Date.now();this.available=this.available.filter(function(h){return s-h.lastUsed>o.idle?(h.destroy(),!1):!0}),this.available.length!==0?this.timeoutId=setTimeout(function(){return o.gc()},f):this.timeoutId=0},n.exports=a},{}],14:[function(r,n,u){var f=2;n.exports=function(a,o,s,h,c,i){var I=s/a,A=h/o,l=(2*i+f+1)/c;if(l>.5)return[[s,h]];var d=Math.ceil(Math.log(Math.min(I,A))/Math.log(l));if(d<=1)return[[s,h]];for(var p=[],m=0;m<d;m++){var E=Math.round(Math.pow(Math.pow(a,d-m-1)*Math.pow(s,m+1),1/d)),C=Math.round(Math.pow(Math.pow(o,d-m-1)*Math.pow(h,m+1),1/d));p.push([E,C])}return p}},{}],15:[function(r,n,u){var f=1e-5;function a(s){var h=Math.round(s);return Math.abs(s-h)<f?h:Math.floor(s)}function o(s){var h=Math.round(s);return Math.abs(s-h)<f?h:Math.ceil(s)}n.exports=function(s){var h=s.toWidth/s.width,c=s.toHeight/s.height,i=a(s.srcTileSize*h)-2*s.destTileBorder,I=a(s.srcTileSize*c)-2*s.destTileBorder;if(i<1||I<1)throw new Error("Internal error in pica: target tile width/height is too small.");var A,l,d,p,m,E,C=[],_;for(p=0;p<s.toHeight;p+=I)for(d=0;d<s.toWidth;d+=i)A=d-s.destTileBorder,A<0&&(A=0),m=d+i+s.destTileBorder-A,A+m>=s.toWidth&&(m=s.toWidth-A),l=p-s.destTileBorder,l<0&&(l=0),E=p+I+s.destTileBorder-l,l+E>=s.toHeight&&(E=s.toHeight-l),_={toX:A,toY:l,toWidth:m,toHeight:E,toInnerX:d,toInnerY:p,toInnerWidth:i,toInnerHeight:I,offsetX:A/h-a(A/h),offsetY:l/c-a(l/c),scaleX:h,scaleY:c,x:a(A/h),y:a(l/c),width:o(m/h),height:o(E/c)},C.push(_);return C}},{}],16:[function(r,n,u){function f(a){return Object.prototype.toString.call(a)}n.exports.isCanvas=function(a){var o=f(a);return o==="[object HTMLCanvasElement]"||o==="[object OffscreenCanvas]"||o==="[object Canvas]"},n.exports.isImage=function(a){return f(a)==="[object HTMLImageElement]"},n.exports.isImageBitmap=function(a){return f(a)==="[object ImageBitmap]"},n.exports.limiter=function(a){var o=0,s=[];function h(){o<a&&s.length&&(o++,s.shift()())}return function(c){return new Promise(function(i,I){s.push(function(){c().then(function(A){i(A),o--,h()},function(A){I(A),o--,h()})}),h()})}},n.exports.cib_quality_name=function(a){switch(a){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},n.exports.cib_support=function(a){return Promise.resolve().then(function(){if(typeof createImageBitmap>"u")return!1;var o=a(100,100);return createImageBitmap(o,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(s){var h=s.width===10;return s.close(),o=null,h})}).catch(function(){return!1})},n.exports.worker_offscreen_canvas_support=function(){return new Promise(function(a,o){if(typeof OffscreenCanvas>"u"){a(!1);return}function s(i){if(typeof createImageBitmap>"u"){i.postMessage(!1);return}Promise.resolve().then(function(){var I=new OffscreenCanvas(10,10),A=I.getContext("2d");return A.rect(0,0,1,1),createImageBitmap(I,0,0,1,1)}).then(function(){return i.postMessage(!0)},function(){return i.postMessage(!1)})}var h=btoa("(".concat(s.toString(),")(self);")),c=new Worker("data:text/javascript;base64,".concat(h));c.onmessage=function(i){return a(i.data)},c.onerror=o}).then(function(a){return a},function(){return!1})},n.exports.can_use_canvas=function(a){var o=!1;try{var s=a(2,1),h=s.getContext("2d"),c=h.createImageData(2,1);c.data[0]=12,c.data[1]=23,c.data[2]=34,c.data[3]=255,c.data[4]=45,c.data[5]=56,c.data[6]=67,c.data[7]=255,h.putImageData(c,0,0),c=null,c=h.getImageData(0,0,2,1),c.data[0]===12&&c.data[1]===23&&c.data[2]===34&&c.data[3]===255&&c.data[4]===45&&c.data[5]===56&&c.data[6]===67&&c.data[7]===255&&(o=!0)}catch{}return o},n.exports.cib_can_use_region=function(){return new Promise(function(a){if(typeof Image>"u"||typeof createImageBitmap>"u"){a(!1);return}var o=new Image;o.src="data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z",o.onload=function(){createImageBitmap(o,0,0,o.width,o.height).then(function(s){s.width===o.width&&s.height===o.height?a(!0):a(!1)},function(){return a(!1)})},o.onerror=function(){return a(!1)}})}},{}],17:[function(r,n,u){n.exports=function(){var f=r("./mathlib"),a;onmessage=function(o){var s=o.data.opts;if(!s.src&&s.srcBitmap){var h=new OffscreenCanvas(s.width,s.height),c=h.getContext("2d");c.drawImage(s.srcBitmap,0,0),s.src=c.getImageData(0,0,s.width,s.height).data,h.width=h.height=0,h=null,s.srcBitmap.close(),s.srcBitmap=null}a||(a=new f(o.data.features));var i=a.resizeAndUnsharp(s);postMessage({data:i},[i.buffer])}}},{"./mathlib":1}],18:[function(r,n,u){var f,a,o,s,h,c,i,I;function A(p){p<.5&&(p=.5);var m=Math.exp(.726*.726)/p,E=Math.exp(-m),C=Math.exp(-2*m),_=(1-E)*(1-E)/(1+2*m*E-C);return f=_,a=_*(m-1)*E,o=_*(m+1)*E,s=-_*C,h=2*E,c=-C,i=(f+a)/(1-h-c),I=(o+s)/(1-h-c),new Float32Array([f,a,o,s,h,c,i,I])}function l(p,m,E,C,_,x){var U,b,B,M,D,j,S,P,H,R,g,y,w,Q;for(H=0;H<x;H++){for(j=H*_,S=H,P=0,U=p[j],D=U*C[6],M=D,g=C[0],y=C[1],w=C[4],Q=C[5],R=0;R<_;R++)b=p[j],B=b*g+U*y+M*w+D*Q,D=M,M=B,U=b,E[P]=M,P++,j++;for(j--,P--,S+=x*(_-1),U=p[j],D=U*C[7],M=D,b=U,g=C[2],y=C[3],R=_-1;R>=0;R--)B=b*g+U*y+M*w+D*Q,D=M,M=B,U=b,b=p[j],m[S]=E[P]+M,j--,P--,S-=x}}function d(p,m,E,C){if(C){var _=new Uint16Array(p.length),x=new Float32Array(Math.max(m,E)),U=A(C);l(p,_,x,U,m,E),l(_,p,x,U,E,m)}}n.exports=d},{}],19:[function(r,n,u){var f=r("object-assign"),a=r("./lib/base64decode"),o=r("./lib/wa_detect"),s={js:!0,wasm:!0};function h(c){if(!(this instanceof h))return new h(c);var i=f({},s,c||{});if(this.options=i,this.__cache={},this.__init_promise=null,this.__modules=i.modules||{},this.__memory=null,this.__wasm={},this.__isLE=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1,!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}h.prototype.has_wasm=o,h.prototype.use=function(c){return this.__modules[c.name]=c,this.options.wasm&&this.has_wasm()&&c.wasm_fn?this[c.name]=c.wasm_fn:this[c.name]=c.fn,this},h.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error(`mathlib: only "wasm" was enabled, but it's not supported`));var c=this;return this.__init_promise=Promise.all(Object.keys(c.__modules).map(function(i){var I=c.__modules[i];return!c.options.wasm||!c.has_wasm()||!I.wasm_fn||c.__wasm[i]?null:WebAssembly.compile(c.__base64decode(I.wasm_src)).then(function(A){c.__wasm[i]=A})})).then(function(){return c}),this.__init_promise},h.prototype.__base64decode=a,h.prototype.__reallocate=function(c){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(c/(64*1024))}),this.__memory;var i=this.__memory.buffer.byteLength;return i<c&&this.__memory.grow(Math.ceil((c-i)/(64*1024))),this.__memory},h.prototype.__instance=function(c,i,I){if(i&&this.__reallocate(i),!this.__wasm[c]){var A=this.__modules[c];this.__wasm[c]=new WebAssembly.Module(this.__base64decode(A.wasm_src))}if(!this.__cache[c]){var l={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[c]=new WebAssembly.Instance(this.__wasm[c],{env:f(l,I||{})})}return this.__cache[c]},h.prototype.__align=function(c,i){i=i||8;var I=c%i;return c+(I?i-I:0)},n.exports=h},{"./lib/base64decode":20,"./lib/wa_detect":21,"object-assign":22}],20:[function(r,n,u){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";n.exports=function(a){for(var o=a.replace(/[\r\n=]/g,""),s=o.length,h=new Uint8Array(s*3>>2),c=0,i=0,I=0;I<s;I++)I%4===0&&I&&(h[i++]=c>>16&255,h[i++]=c>>8&255,h[i++]=c&255),c=c<<6|f.indexOf(o.charAt(I));var A=s%4*6;return A===0?(h[i++]=c>>16&255,h[i++]=c>>8&255,h[i++]=c&255):A===18?(h[i++]=c>>10&255,h[i++]=c>>2&255):A===12&&(h[i++]=c>>4&255),h}},{}],21:[function(r,n,u){var f;n.exports=function(){if(typeof f<"u"||(f=!1,typeof WebAssembly>"u"))return f;try{var a=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),o=new WebAssembly.Module(a),s=new WebAssembly.Instance(o,{});return s.exports.test(4)!==0&&(f=!0),f}catch{}return f}},{}],22:[function(r,n,u){var f=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function s(c){if(c==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(c)}function h(){try{if(!Object.assign)return!1;var c=new String("abc");if(c[5]="de",Object.getOwnPropertyNames(c)[0]==="5")return!1;for(var i={},I=0;I<10;I++)i["_"+String.fromCharCode(I)]=I;var A=Object.getOwnPropertyNames(i).map(function(d){return i[d]});if(A.join("")!=="0123456789")return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach(function(d){l[d]=d}),Object.keys(Object.assign({},l)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}n.exports=h()?Object.assign:function(c,i){for(var I,A=s(c),l,d=1;d<arguments.length;d++){I=Object(arguments[d]);for(var p in I)a.call(I,p)&&(A[p]=I[p]);if(f){l=f(I);for(var m=0;m<l.length;m++)o.call(I,l[m])&&(A[l[m]]=I[l[m]])}}return A}},{}],23:[function(r,n,u){var f=arguments[3],a=arguments[4],o=arguments[5],s=JSON.stringify;n.exports=function(h,c){for(var i,I=Object.keys(o),A=0,l=I.length;A<l;A++){var d=I[A],p=o[d].exports;if(p===h||p&&p.default===h){i=d;break}}if(!i){i=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var m={},A=0,l=I.length;A<l;A++){var d=I[A];m[d]=d}a[i]=["function(require,module,exports){"+h+"(self); }",m]}var E=Math.floor(Math.pow(16,8)*Math.random()).toString(16),C={};C[i]=i,a[E]=["function(require,module,exports){var f = require("+s(i)+");(f.default ? f.default : f)(self);}",C];var _={};x(E);function x(j){_[j]=!0;for(var S in a[j][1]){var P=a[j][1][S];_[P]||x(P)}}var U="("+f+")({"+Object.keys(_).map(function(j){return s(j)+":["+a[j][0]+","+s(a[j][1])+"]"}).join(",")+"},{},["+s(E)+"])",b=window.URL||window.webkitURL||window.mozURL||window.msURL,B=new Blob([U],{type:"text/javascript"});if(c&&c.bare)return B;var M=b.createObjectURL(B),D=new Worker(M);return D.objectURL=M,D}},{}],"/index.js":[function(r,n,u){function f(g,y){return c(g)||h(g,y)||o(g,y)||a()}function a(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o(g,y){if(g){if(typeof g=="string")return s(g,y);var w=Object.prototype.toString.call(g).slice(8,-1);if(w==="Object"&&g.constructor&&(w=g.constructor.name),w==="Map"||w==="Set")return Array.from(g);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return s(g,y)}}function s(g,y){(y==null||y>g.length)&&(y=g.length);for(var w=0,Q=new Array(y);w<y;w++)Q[w]=g[w];return Q}function h(g,y){var w=g==null?null:typeof Symbol<"u"&&g[Symbol.iterator]||g["@@iterator"];if(w!=null){var Q=[],v=!0,O=!1,k,G;try{for(w=w.call(g);!(v=(k=w.next()).done)&&(Q.push(k.value),!(y&&Q.length===y));v=!0);}catch(F){O=!0,G=F}finally{try{!v&&w.return!=null&&w.return()}finally{if(O)throw G}}return Q}}function c(g){if(Array.isArray(g))return g}var i=r("object-assign"),I=r("webworkify"),A=r("./lib/mathlib"),l=r("./lib/pool"),d=r("./lib/utils"),p=r("./lib/worker"),m=r("./lib/stepper"),E=r("./lib/tiler"),C=r("./lib/mm_resize/resize_filter_info"),_={},x=!1;try{typeof navigator<"u"&&navigator.userAgent&&(x=navigator.userAgent.indexOf("Safari")>=0)}catch{}var U=1;typeof navigator<"u"&&(U=Math.min(navigator.hardwareConcurrency||1,4));var b={tile:1024,concurrency:U,features:["js","wasm","ww"],idle:2e3,createCanvas:function(g,y){var w=document.createElement("canvas");return w.width=g,w.height=y,w}},B={filter:"mks2013",unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0},M=!1,D=!1,j=!1,S=!1,P=!1;function H(){return{value:I(p),destroy:function(){if(this.value.terminate(),typeof window<"u"){var g=window.URL||window.webkitURL||window.mozURL||window.msURL;g&&g.revokeObjectURL&&this.value.objectURL&&g.revokeObjectURL(this.value.objectURL)}}}}function R(g){if(!(this instanceof R))return new R(g);this.options=i({},b,g||{});var y="lk_".concat(this.options.concurrency);this.__limit=_[y]||d.limiter(this.options.concurrency),_[y]||(_[y]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}R.prototype.init=function(){var g=this;if(this.__initPromise)return this.__initPromise;if(typeof ImageData<"u"&&typeof Uint8ClampedArray<"u")try{new ImageData(new Uint8ClampedArray(400),10,10),M=!0}catch{}typeof ImageBitmap<"u"&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?D=!0:this.debug("ImageBitmap does not support .close(), disabled"));var y=this.options.features.slice();if(y.indexOf("all")>=0&&(y=["cib","wasm","js","ww"]),this.__requested_features=y,this.__mathlib=new A(y),y.indexOf("ww")>=0&&typeof window<"u"&&"Worker"in window)try{var w=r("webworkify")(function(){});w.terminate(),this.features.ww=!0;var Q="wp_".concat(JSON.stringify(this.options));_[Q]?this.__workersPool=_[Q]:(this.__workersPool=new l(H,this.options.idle),_[Q]=this.__workersPool)}catch{}var v=this.__mathlib.init().then(function(F){i(g.features,F.features)}),O;D?O=d.cib_support(this.options.createCanvas).then(function(F){if(g.features.cib&&y.indexOf("cib")<0){g.debug("createImageBitmap() resize supported, but disabled by config");return}y.indexOf("cib")>=0&&(g.features.cib=F)}):O=Promise.resolve(!1),j=d.can_use_canvas(this.options.createCanvas);var k;D&&M&&y.indexOf("ww")!==-1?k=d.worker_offscreen_canvas_support():k=Promise.resolve(!1),k=k.then(function(F){S=F});var G=d.cib_can_use_region().then(function(F){P=F});return this.__initPromise=Promise.all([v,O,k,G]).then(function(){return g}),this.__initPromise},R.prototype.__invokeResize=function(g,y){var w=this;return y.__mathCache=y.__mathCache||{},Promise.resolve().then(function(){return w.features.ww?new Promise(function(Q,v){var O=w.__workersPool.acquire();y.cancelToken&&y.cancelToken.catch(function(G){return v(G)}),O.value.onmessage=function(G){O.release(),G.data.err?v(G.data.err):Q(G.data)};var k=[];g.src&&k.push(g.src.buffer),g.srcBitmap&&k.push(g.srcBitmap),O.value.postMessage({opts:g,features:w.__requested_features,preload:{wasm_nodule:w.__mathlib.__}},k)}):{data:w.__mathlib.resizeAndUnsharp(g,y.__mathCache)}})},R.prototype.__extractTileData=function(g,y,w,Q,v){if(this.features.ww&&S&&(d.isCanvas(y)||P))return this.debug("Create tile for OffscreenCanvas"),createImageBitmap(Q.srcImageBitmap||y,g.x,g.y,g.width,g.height).then(function(G){return v.srcBitmap=G,v});if(d.isCanvas(y))return Q.srcCtx||(Q.srcCtx=y.getContext("2d")),this.debug("Get tile pixel data"),v.src=Q.srcCtx.getImageData(g.x,g.y,g.width,g.height).data,v;this.debug("Draw tile imageBitmap/image to temporary canvas");var O=this.options.createCanvas(g.width,g.height),k=O.getContext("2d");return k.globalCompositeOperation="copy",k.drawImage(Q.srcImageBitmap||y,g.x,g.y,g.width,g.height,0,0,g.width,g.height),this.debug("Get tile pixel data"),v.src=k.getImageData(0,0,g.width,g.height).data,O.width=O.height=0,v},R.prototype.__landTileData=function(g,y,w){var Q;if(this.debug("Convert raw rgba tile result to ImageData"),y.bitmap)return w.toCtx.drawImage(y.bitmap,g.toX,g.toY),null;if(M)Q=new ImageData(new Uint8ClampedArray(y.data),g.toWidth,g.toHeight);else if(Q=w.toCtx.createImageData(g.toWidth,g.toHeight),Q.data.set)Q.data.set(y.data);else for(var v=Q.data.length-1;v>=0;v--)Q.data[v]=y.data[v];return this.debug("Draw tile"),x?w.toCtx.putImageData(Q,g.toX,g.toY,g.toInnerX-g.toX,g.toInnerY-g.toY,g.toInnerWidth+1e-5,g.toInnerHeight+1e-5):w.toCtx.putImageData(Q,g.toX,g.toY,g.toInnerX-g.toX,g.toInnerY-g.toY,g.toInnerWidth,g.toInnerHeight),null},R.prototype.__tileAndResize=function(g,y,w){var Q=this,v={srcCtx:null,srcImageBitmap:null,isImageBitmapReused:!1,toCtx:null},O=function(k){return Q.__limit(function(){if(w.canceled)return w.cancelToken;var G={width:k.width,height:k.height,toWidth:k.toWidth,toHeight:k.toHeight,scaleX:k.scaleX,scaleY:k.scaleY,offsetX:k.offsetX,offsetY:k.offsetY,filter:w.filter,unsharpAmount:w.unsharpAmount,unsharpRadius:w.unsharpRadius,unsharpThreshold:w.unsharpThreshold};return Q.debug("Invoke resize math"),Promise.resolve(G).then(function(F){return Q.__extractTileData(k,g,w,v,F)}).then(function(F){return Q.debug("Invoke resize math"),Q.__invokeResize(F,w)}).then(function(F){return w.canceled?w.cancelToken:(v.srcImageData=null,Q.__landTileData(k,F,v))})})};return Promise.resolve().then(function(){if(v.toCtx=y.getContext("2d"),d.isCanvas(g))return null;if(d.isImageBitmap(g))return v.srcImageBitmap=g,v.isImageBitmapReused=!0,null;if(d.isImage(g))return D?(Q.debug("Decode image via createImageBitmap"),createImageBitmap(g).then(function(k){v.srcImageBitmap=k}).catch(function(k){return null})):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')}).then(function(){if(w.canceled)return w.cancelToken;Q.debug("Calculate tiles");var k=E({width:w.width,height:w.height,srcTileSize:Q.options.tile,toWidth:w.toWidth,toHeight:w.toHeight,destTileBorder:w.__destTileBorder}),G=k.map(function(L){return O(L)});function F(L){L.srcImageBitmap&&(L.isImageBitmapReused||L.srcImageBitmap.close(),L.srcImageBitmap=null)}return Q.debug("Process tiles"),Promise.all(G).then(function(){return Q.debug("Finished!"),F(v),y},function(L){throw F(v),L})})},R.prototype.__processStages=function(g,y,w,Q){var v=this;if(Q.canceled)return Q.cancelToken;var O=g.shift(),k=f(O,2),G=k[0],F=k[1],L=g.length===0,Y;L||C.q2f.indexOf(Q.filter)<0?Y=Q.filter:Q.filter==="box"?Y="box":Y="hamming",Q=i({},Q,{toWidth:G,toHeight:F,filter:Y});var W;return L||(W=this.options.createCanvas(G,F)),this.__tileAndResize(y,L?w:W,Q).then(function(){return L?w:(Q.width=G,Q.height=F,v.__processStages(g,W,w,Q))}).then(function(_t){return W&&(W.width=W.height=0),_t})},R.prototype.__resizeViaCreateImageBitmap=function(g,y,w){var Q=this,v=y.getContext("2d");return this.debug("Resize via createImageBitmap()"),createImageBitmap(g,{resizeWidth:w.toWidth,resizeHeight:w.toHeight,resizeQuality:d.cib_quality_name(C.f2q[w.filter])}).then(function(O){if(w.canceled)return w.cancelToken;if(!w.unsharpAmount)return v.drawImage(O,0,0),O.close(),v=null,Q.debug("Finished!"),y;Q.debug("Unsharp result");var k=Q.options.createCanvas(w.toWidth,w.toHeight),G=k.getContext("2d");G.drawImage(O,0,0),O.close();var F=G.getImageData(0,0,w.toWidth,w.toHeight);return Q.__mathlib.unsharp_mask(F.data,w.toWidth,w.toHeight,w.unsharpAmount,w.unsharpRadius,w.unsharpThreshold),v.putImageData(F,0,0),k.width=k.height=0,F=G=k=v=null,Q.debug("Finished!"),y})},R.prototype.resize=function(g,y,w){var Q=this;this.debug("Start resize...");var v=i({},B);if(isNaN(w)?w&&(v=i(v,w)):v=i(v,{quality:w}),v.toWidth=y.width,v.toHeight=y.height,v.width=g.naturalWidth||g.width,v.height=g.naturalHeight||g.height,Object.prototype.hasOwnProperty.call(v,"quality")){if(v.quality<0||v.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(v.quality));v.filter=C.q2f[v.quality]}if(y.width===0||y.height===0)return Promise.reject(new Error("Invalid output size: ".concat(y.width,"x").concat(y.height)));v.unsharpRadius>2&&(v.unsharpRadius=2),v.canceled=!1,v.cancelToken&&(v.cancelToken=v.cancelToken.then(function(k){throw v.canceled=!0,k},function(k){throw v.canceled=!0,k}));var O=3;return v.__destTileBorder=Math.ceil(Math.max(O,2.5*v.unsharpRadius|0)),this.init().then(function(){if(v.canceled)return v.cancelToken;if(Q.features.cib){if(C.q2f.indexOf(v.filter)>=0)return Q.__resizeViaCreateImageBitmap(g,y,v);Q.debug("cib is enabled, but not supports provided filter, fallback to manual math")}if(!j){var k=new Error("Pica: cannot use getImageData on canvas, make sure fingerprinting protection isn't enabled");throw k.code="ERR_GET_IMAGE_DATA",k}var G=m(v.width,v.height,v.toWidth,v.toHeight,Q.options.tile,v.__destTileBorder);return Q.__processStages(G,g,y,v)})},R.prototype.resizeBuffer=function(g){var y=this,w=i({},B,g);if(Object.prototype.hasOwnProperty.call(w,"quality")){if(w.quality<0||w.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(w.quality));w.filter=C.q2f[w.quality]}return this.init().then(function(){return y.__mathlib.resizeAndUnsharp(w)})},R.prototype.toBlob=function(g,y,w){return y=y||"image/png",new Promise(function(Q){if(g.toBlob){g.toBlob(function(F){return Q(F)},y,w);return}if(g.convertToBlob){Q(g.convertToBlob({type:y,quality:w}));return}for(var v=atob(g.toDataURL(y,w).split(",")[1]),O=v.length,k=new Uint8Array(O),G=0;G<O;G++)k[G]=v.charCodeAt(G);Q(new Blob([k],{type:y}))})},R.prototype.debug=function(){},n.exports=R},{"./lib/mathlib":1,"./lib/mm_resize/resize_filter_info":7,"./lib/pool":13,"./lib/stepper":14,"./lib/tiler":15,"./lib/utils":16,"./lib/worker":17,"object-assign":22,webworkify:23}]},{},[])("/index.js")})})(Ht);var Be=Ht.exports;const be=le(Be);function Ft(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,n)}return r}function it(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ft(Object(r),!0).forEach(function(n){ve(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ft(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ee(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tt(n.key),n)}}function ye(t,e,r){return e&&Lt(t.prototype,e),r&&Lt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ve(t,e,r){return e=Tt(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function at(){return at=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},at.apply(this,arguments)}function Ce(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tt(t){var e=Ce(t,"string");return typeof e=="symbol"?e:String(e)}var qt={exports:{}};(function(t){typeof window>"u"||function(e){var r=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,n=e.Blob&&function(){try{return!!new Blob}catch{return!1}}(),u=n&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),f=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,a=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,o=(n||f)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(s){var h,c,i,I,A,l,d,p,m;if(h=s.match(a),!h)throw new Error("invalid data URI");for(c=h[2]?h[1]:"text/plain"+(h[3]||";charset=US-ASCII"),i=!!h[4],I=s.slice(h[0].length),i?A=atob(I):A=decodeURIComponent(I),l=new ArrayBuffer(A.length),d=new Uint8Array(l),p=0;p<A.length;p+=1)d[p]=A.charCodeAt(p);return n?new Blob([u?d:l],{type:c}):(m=new f,m.append(l),m.getBlob(c))};e.HTMLCanvasElement&&!r.toBlob&&(r.mozGetAsFile?r.toBlob=function(s,h,c){var i=this;setTimeout(function(){c&&r.toDataURL&&o?s(o(i.toDataURL(h,c))):s(i.mozGetAsFile("blob",h))})}:r.toDataURL&&o&&(r.msToBlob?r.toBlob=function(s,h,c){var i=this;setTimeout(function(){(h&&h!=="image/png"||c)&&r.toDataURL&&o?s(o(i.toDataURL(h,c))):s(i.msToBlob(h))})}:r.toBlob=function(s,h,c){var i=this;setTimeout(function(){s(o(i.toDataURL(h,c)))})})),t.exports?t.exports=o:e.dataURLtoBlob=o}(window)})(qt);var Wt=qt.exports,Qe=function(t){return typeof Blob>"u"?!1:t instanceof Blob||Object.prototype.toString.call(t)==="[object Blob]"},zt={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},_e=typeof window<"u"&&typeof window.document<"u",z=_e?window:{},ot=function(t){return t>0&&t<1/0},xe=Array.prototype.slice;function Ut(t){return Array.from?Array.from(t):xe.call(t)}var Ue=/^image\/.+$/;function Mt(t){return Ue.test(t)}function Me(t){var e=Mt(t)?t.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var Yt=String.fromCharCode;function De(t,e,r){var n="",u;for(r+=e,u=e;u<r;u+=1)n+=Yt(t.getUint8(u));return n}var je=z.btoa;function Jt(t,e){for(var r=[],n=8192,u=new Uint8Array(t);u.length>0;)r.push(Yt.apply(null,Ut(u.subarray(0,n)))),u=u.subarray(n);return"data:".concat(e,";base64,").concat(je(r.join("")))}function ke(t){var e=new DataView(t),r;try{var n,u,f;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var a=e.byteLength,o=2;o+1<a;){if(e.getUint8(o)===255&&e.getUint8(o+1)===225){u=o;break}o+=1}if(u){var s=u+4,h=u+10;if(De(e,s,4)==="Exif"){var c=e.getUint16(h);if(n=c===18761,(n||c===19789)&&e.getUint16(h+2,n)===42){var i=e.getUint32(h+4,n);i>=8&&(f=h+i)}}}if(f){var I=e.getUint16(f,n),A,l;for(l=0;l<I;l+=1)if(A=f+l*12+2,e.getUint16(A,n)===274){A+=8,r=e.getUint16(A,n),e.setUint16(A,1,n);break}}}catch{r=1}return r}function Pe(t){var e=0,r=1,n=1;switch(t){case 2:r=-1;break;case 3:e=-180;break;case 4:n=-1;break;case 5:e=90,n=-1;break;case 6:e=90;break;case 7:e=90,r=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:r,scaleY:n}}var Se=/\.\d*(?:0|9){12}\d*$/;function Nt(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Se.test(t)?Math.round(t*e)/e:t}function X(t){var e=t.aspectRatio,r=t.height,n=t.width,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",f=ot(n),a=ot(r);if(f&&a){var o=r*e;(u==="contain"||u==="none")&&o>n||u==="cover"&&o<n?r=n/e:n=r*e}else f?r=n/e:a&&(n=r*e);return{width:n,height:r}}function Re(t){for(var e=Ut(new Uint8Array(t)),r=e.length,n=[],u=0;u+3<r;){var f=e[u],a=e[u+1];if(f===255&&a===218)break;if(f===255&&a===216)u+=2;else{var o=e[u+2]*256+e[u+3],s=u+o+2,h=e.slice(u,s);n.push(h),u=s}}return n.reduce(function(c,i){return i[0]===255&&i[1]===225?c.concat(i):c},[])}function Oe(t,e){var r=Ut(new Uint8Array(t));if(r[2]!==255||r[3]!==224)return t;var n=r[4]*256+r[5],u=[255,216].concat(e,r.slice(4+n));return new Uint8Array(u)}var Ge=z.ArrayBuffer,Dt=z.FileReader,J=z.URL||z.webkitURL,He=/\.\w+$/,Fe=z.Compressor,Le=function(){function t(e,r){Ee(this,t),this.file=e,this.exif=[],this.image=new Image,this.options=it(it({},zt),r),this.aborted=!1,this.result=null,this.init()}return ye(t,[{key:"init",value:function(){var e=this,r=this.file,n=this.options;if(!Qe(r)){this.fail(new Error("The first argument must be a File or Blob object."));return}var u=r.type;if(!Mt(u)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!J||!Dt){this.fail(new Error("The current browser does not support image compression."));return}Ge||(n.checkOrientation=!1,n.retainExif=!1);var f=u==="image/jpeg",a=f&&n.checkOrientation,o=f&&n.retainExif;if(J&&!a&&!o)this.load({url:J.createObjectURL(r)});else{var s=new Dt;this.reader=s,s.onload=function(h){var c=h.target,i=c.result,I={},A=1;a&&(A=ke(i),A>1&&at(I,Pe(A))),o&&(e.exif=Re(i)),a||o?!J||A>1?I.url=Jt(i,u):I.url=J.createObjectURL(r):I.url=i,e.load(I)},s.onabort=function(){e.fail(new Error("Aborted to read the image with FileReader."))},s.onerror=function(){e.fail(new Error("Failed to read the image with FileReader."))},s.onloadend=function(){e.reader=null},a||o?s.readAsArrayBuffer(r):s.readAsDataURL(r)}}},{key:"load",value:function(e){var r=this,n=this.file,u=this.image;u.onload=function(){r.draw(it(it({},e),{},{naturalWidth:u.naturalWidth,naturalHeight:u.naturalHeight}))},u.onabort=function(){r.fail(new Error("Aborted to load the image."))},u.onerror=function(){r.fail(new Error("Failed to load the image."))},z.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(z.navigator.userAgent)&&(u.crossOrigin="anonymous"),u.alt=n.name,u.src=e.url}},{key:"draw",value:function(e){var r=this,n=e.naturalWidth,u=e.naturalHeight,f=e.rotate,a=f===void 0?0:f,o=e.scaleX,s=o===void 0?1:o,h=e.scaleY,c=h===void 0?1:h,i=this.file,I=this.image,A=this.options,l=document.createElement("canvas"),d=l.getContext("2d"),p=Math.abs(a)%180===90,m=(A.resize==="contain"||A.resize==="cover")&&ot(A.width)&&ot(A.height),E=Math.max(A.maxWidth,0)||1/0,C=Math.max(A.maxHeight,0)||1/0,_=Math.max(A.minWidth,0)||0,x=Math.max(A.minHeight,0)||0,U=n/u,b=A.width,B=A.height;if(p){var M=[C,E];E=M[0],C=M[1];var D=[x,_];_=D[0],x=D[1];var j=[B,b];b=j[0],B=j[1]}m&&(U=b/B);var S=X({aspectRatio:U,width:E,height:C},"contain");E=S.width,C=S.height;var P=X({aspectRatio:U,width:_,height:x},"cover");if(_=P.width,x=P.height,m){var H=X({aspectRatio:U,width:b,height:B},A.resize);b=H.width,B=H.height}else{var R=X({aspectRatio:U,width:b,height:B}),g=R.width;b=g===void 0?n:g;var y=R.height;B=y===void 0?u:y}b=Math.floor(Nt(Math.min(Math.max(b,_),E))),B=Math.floor(Nt(Math.min(Math.max(B,x),C)));var w=-b/2,Q=-B/2,v=b,O=B,k=[];if(m){var G=0,F=0,L=n,Y=u,W=X({aspectRatio:U,width:n,height:u},{contain:"cover",cover:"contain"}[A.resize]);L=W.width,Y=W.height,G=(n-L)/2,F=(u-Y)/2,k.push(G,F,L,Y)}if(k.push(w,Q,v,O),p){var _t=[B,b];b=_t[0],B=_t[1]}l.width=b,l.height=B,Mt(A.mimeType)||(A.mimeType=i.type);var Ae="transparent";i.size>A.convertSize&&A.convertTypes.indexOf(A.mimeType)>=0&&(A.mimeType="image/jpeg");var ce=A.mimeType==="image/jpeg";if(ce&&(Ae="#fff"),d.fillStyle=Ae,d.fillRect(0,0,b,B),A.beforeDraw&&A.beforeDraw.call(this,d,l),!this.aborted&&(d.save(),d.translate(b/2,B/2),d.rotate(a*Math.PI/180),d.scale(s,c),d.drawImage.apply(d,[I].concat(k)),d.restore(),A.drew&&A.drew.call(this,d,l),!this.aborted)){var he=function(et){if(!r.aborted){var ue=function(rt){return r.done({naturalWidth:n,naturalHeight:u,result:rt})};if(et&&ce&&A.retainExif&&r.exif&&r.exif.length>0){var fe=function(rt){return ue(Wt(Jt(Oe(rt,r.exif),A.mimeType)))};if(et.arrayBuffer)et.arrayBuffer().then(fe).catch(function(){r.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var K=new Dt;r.reader=K,K.onload=function(rt){var rn=rt.target;fe(rn.result)},K.onabort=function(){r.fail(new Error("Aborted to read the compressed image with FileReader."))},K.onerror=function(){r.fail(new Error("Failed to read the compressed image with FileReader."))},K.onloadend=function(){r.reader=null},K.readAsArrayBuffer(et)}}else ue(et)}};l.toBlob?l.toBlob(he,A.mimeType,A.quality):he(Wt(l.toDataURL(A.mimeType,A.quality)))}}},{key:"done",value:function(e){var r=e.naturalWidth,n=e.naturalHeight,u=e.result,f=this.file,a=this.image,o=this.options;if(J&&a.src.indexOf("blob:")===0&&J.revokeObjectURL(a.src),u)if(o.strict&&!o.retainExif&&u.size>f.size&&o.mimeType===f.type&&!(o.width>r||o.height>n||o.minWidth>r||o.minHeight>n||o.maxWidth<r||o.maxHeight<n))u=f;else{var s=new Date;u.lastModified=s.getTime(),u.lastModifiedDate=s,u.name=f.name,u.name&&u.type!==f.type&&(u.name=u.name.replace(He,Me(u.type)))}else u=f;this.result=u,o.success&&o.success.call(this,u)}},{key:"fail",value:function(e){var r=this.options;if(r.error)r.error.call(this,e);else throw e}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=Fe,t}},{key:"setDefaults",value:function(e){at(zt,e)}}]),t}();function Te(){return window.navigator.brave!=null?window.navigator.brave.isBrave.name=="isBrave":!1}let Kt;pe=q.forwardRef((t,e)=>{const{imageSrc:r,imageType:n,onImageCropped:u,width:f,height:a}=t,[o,s]=q.useState({x:0,y:0}),[h,c]=q.useState(1),[i,I]=q.useState(null);q.useState(null);const A=q.useCallback((x,U)=>{I(U)},[]);q.useImperativeHandle(e,()=>({async showCroppedImage(){try{if(r){const x=await E(r,i),U=await p(x),b=Te()?await d(x):await l(U),B=await p(b);u(B)}else return"Nothing"}catch(x){console.error(x)}}}));async function l(x){const U=be();let b=await C(x);const B=document.createElement("canvas");return B.height=128,B.width=128,new Promise(M=>{M(U.resize(b,B,{unsharpAmount:100,unsharpRadius:.7,unsharpThreshold:2}).then(D=>U.toBlob(D,n,1)))})}async function d(x){return new Promise((U,b)=>{new Le(x,{quality:1,strict:!0,maxWidth:128,maxHeight:128,checkOrientation:!1,success:U,error:b})})}const p=async x=>await m(x),m=x=>new Promise((U,b)=>{const B=new FileReader;B.readAsDataURL(x),B.onload=()=>U(B.result),B.onerror=M=>b(M)});async function E(x,U){const b=await C(x),B=document.createElement("canvas");B.width=U.width,B.height=U.height;const M=B.getContext("2d"),D="none.jpg";return M.drawImage(b,U.x,U.y,U.width,U.height,0,0,U.width,U.height),new Promise((j,S)=>{B.toBlob(P=>{j(new File([P],D,{type:n,lastModified:Date.now()}))},n,1)})}const C=x=>new Promise((U,b)=>{const B=new Image;B.addEventListener("load",()=>U(B)),B.addEventListener("error",M=>b(M)),B.setAttribute("crossOrigin","anonymous"),B.src=x}),_=x=>{c(x)};return Gt.jsx(q.Fragment,{children:Gt.jsx(Kt,{children:Gt.jsx(nn,{image:r,crop:o,zoom:h,aspect:1,onCropChange:s,onCropComplete:A,onZoomChange:_,style:{containerStyle:{width:f||"250px",height:a||"250px",position:"relative",borderRadius:"20px"}}})})})}),Kt=an.div`
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  `;var jt={exports:{}},kt={exports:{}},qe=sn(),Xt=on().EventEmitter;kt.exports=T,kt.exports.default=T;function T(t){if(!(this instanceof T))return new T(t);Xt.call(this),t=t||{},this.concurrency=t.concurrency||1/0,this.timeout=t.timeout||0,this.autostart=t.autostart||!1,this.results=t.results||null,this.pending=0,this.session=0,this.running=!1,this.jobs=[],this.timers={}}qe(T,Xt);var We=["pop","shift","indexOf","lastIndexOf"];We.forEach(function(t){T.prototype[t]=function(){return Array.prototype[t].apply(this.jobs,arguments)}}),T.prototype.slice=function(t,e){return this.jobs=this.jobs.slice(t,e),this},T.prototype.reverse=function(){return this.jobs.reverse(),this};var ze=["push","unshift","splice"];ze.forEach(function(t){T.prototype[t]=function(){var e=Array.prototype[t].apply(this.jobs,arguments);return this.autostart&&this.start(),e}}),Object.defineProperty(T.prototype,"length",{get:function(){return this.pending+this.jobs.length}}),T.prototype.start=function(t){if(t&&Je.call(this,t),this.running=!0,this.pending>=this.concurrency)return;if(this.jobs.length===0){this.pending===0&&Pt.call(this);return}var e=this,r=this.jobs.shift(),n=!0,u=this.session,f=null,a=!1,o=null,s=r.timeout||this.timeout;function h(i,I){n&&e.session===u&&(n=!1,e.pending--,f!==null&&(delete e.timers[f],clearTimeout(f)),i?e.emit("error",i,r):a===!1&&(o!==null&&(e.results[o]=Array.prototype.slice.call(arguments,1)),e.emit("success",I,r)),e.session===u&&(e.pending===0&&e.jobs.length===0?Pt.call(e):e.running&&e.start()))}s&&(f=setTimeout(function(){a=!0,e.listeners("timeout").length>0?e.emit("timeout",h,r):h()},s),this.timers[f]=f),this.results&&(o=this.results.length,this.results[o]=null),this.pending++,e.emit("start",r);var c=r(h);c&&c.then&&typeof c.then=="function"&&c.then(function(i){return h(null,i)}).catch(function(i){return h(i||!0)}),this.running&&this.jobs.length>0&&this.start()},T.prototype.stop=function(){this.running=!1},T.prototype.end=function(t){Ye.call(this),this.jobs.length=0,this.pending=0,Pt.call(this,t)};function Ye(){for(var t in this.timers){var e=this.timers[t];delete this.timers[t],clearTimeout(e)}}function Je(t){var e=this;this.on("error",r),this.on("end",n);function r(u){e.end(u)}function n(u){e.removeListener("error",r),e.removeListener("end",n),t(u,this.results)}}function Pt(t){this.session++,this.running=!1,this.emit("end",t)}var Ne=kt.exports,Z={},st={};Object.defineProperty(st,"__esModule",{value:!0}),st.BMP=void 0,st.BMP={validate(t){return t.toString("ascii",0,2)==="BM"},calculate(t){return{height:Math.abs(t.readInt32LE(22)),width:t.readUInt32LE(18)}}};var At={},V={};Object.defineProperty(V,"__esModule",{value:!0}),V.ICO=void 0;const Ke=1,Xe=6,Ze=16;function Zt(t,e){const r=t.readUInt8(e);return r===0?256:r}function Vt(t,e){const r=Xe+e*Ze;return{height:Zt(t,r+1),width:Zt(t,r)}}V.ICO={validate(t){return t.readUInt16LE(0)!==0?!1:t.readUInt16LE(2)===Ke},calculate(t){const e=t.readUInt16LE(4),r=Vt(t,0);if(e===1)return r;const n=[r];for(let u=1;u<e;u+=1)n.push(Vt(t,u));return{height:r.height,images:n,width:r.width}}},Object.defineProperty(At,"__esModule",{value:!0}),At.CUR=void 0;const Ve=V,$e=2;At.CUR={validate(t){return t.readUInt16LE(0)!==0?!1:t.readUInt16LE(2)===$e},calculate(t){return Ve.ICO.calculate(t)}};var ct={};Object.defineProperty(ct,"__esModule",{value:!0}),ct.DDS=void 0,ct.DDS={validate(t){return t.readUInt32LE(0)===542327876},calculate(t){return{height:t.readUInt32LE(12),width:t.readUInt32LE(16)}}};var ht={};Object.defineProperty(ht,"__esModule",{value:!0}),ht.GIF=void 0;const tr=/^GIF8[79]a/;ht.GIF={validate(t){const e=t.toString("ascii",0,6);return tr.test(e)},calculate(t){return{height:t.readUInt16LE(8),width:t.readUInt16LE(6)}}};var ut={};Object.defineProperty(ut,"__esModule",{value:!0}),ut.ICNS=void 0;const er=8,rr=4,nr=4,ir={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function $t(t,e){const r=e+nr;return[t.toString("ascii",e,r),t.readUInt32BE(r)]}function te(t){const e=ir[t];return{width:e,height:e,type:t}}ut.ICNS={validate(t){return t.toString("ascii",0,4)==="icns"},calculate(t){const e=t.length,r=t.readUInt32BE(rr);let n=er,u=$t(t,n),f=te(u[0]);if(n+=u[1],n===r)return f;const a={height:f.height,images:[f],width:f.width};for(;n<r&&n<e;)u=$t(t,n),f=te(u[0]),n+=u[1],a.images.push(f);return a}};var ft={};Object.defineProperty(ft,"__esModule",{value:!0}),ft.J2C=void 0,ft.J2C={validate(t){return t.toString("hex",0,4)==="ff4fff51"},calculate(t){return{height:t.readUInt32BE(12),width:t.readUInt32BE(8)}}};var lt={};Object.defineProperty(lt,"__esModule",{value:!0}),lt.JP2=void 0;const gt={ftyp:"66747970",ihdr:"69686472",jp2h:"6a703268",jp__:"6a502020",rreq:"72726571",xml_:"786d6c20"},ar=t=>{const e=t.readUInt8(0);let r=1+2*e;const n=t.readUInt16BE(r)*(2+e);r=r+2+n;const u=t.readUInt16BE(r)*(16+e);return r+2+u},ee=t=>({height:t.readUInt32BE(4),width:t.readUInt32BE(8)});lt.JP2={validate(t){const e=t.toString("hex",4,8),r=t.readUInt32BE(0);if(e!==gt.jp__||r<1)return!1;const n=r+4,u=t.readUInt32BE(r);return t.slice(n,n+u).toString("hex",0,4)===gt.ftyp},calculate(t){const e=t.readUInt32BE(0),r=t.readUInt16BE(e+2);let n=e+4+r;switch(t.toString("hex",n,n+4)){case gt.rreq:return n=n+4+4+ar(t.slice(n+4)),ee(t.slice(n+8,n+24));case gt.jp2h:return ee(t.slice(n+8,n+24));default:throw new TypeError("Unsupported header found: "+t.toString("ascii",n,n+4))}}};var dt={},$={};Object.defineProperty($,"__esModule",{value:!0}),$.readUInt=void 0;function or(t,e,r,n){r=r||0;const u=n?"BE":"LE",f="readUInt"+e+u;return t[f].call(t,r)}$.readUInt=or,Object.defineProperty(dt,"__esModule",{value:!0}),dt.JPG=void 0;const tt=$,sr="45786966",Ar=2,St=6,cr=2,hr="4d4d",ur="4949",re=12,fr=2;function lr(t){return t.toString("hex",2,6)===sr}function gr(t,e){return{height:t.readUInt16BE(e),width:t.readUInt16BE(e+2)}}function dr(t,e){const r=St+8,n=tt.readUInt(t,16,r,e);for(let u=0;u<n;u++){const f=r+fr+u*re,a=f+re;if(f>t.length)return;const o=t.slice(f,a);if(tt.readUInt(o,16,0,e)===274)return tt.readUInt(o,16,2,e)!==3||tt.readUInt(o,32,4,e)!==1?void 0:tt.readUInt(o,16,8,e)}}function pr(t,e){const r=t.slice(Ar,e),n=r.toString("hex",St,St+cr),u=n===hr;if(u||n===ur)return dr(r,u)}function mr(t,e){if(e>t.length)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(t[e]!==255)throw new TypeError("Invalid JPG, marker table corrupted")}dt.JPG={validate(t){return t.toString("hex",0,2)==="ffd8"},calculate(t){t=t.slice(4);let e,r;for(;t.length;){const n=t.readUInt16BE(0);if(lr(t)&&(e=pr(t,n)),mr(t,n),r=t[n+1],r===192||r===193||r===194){const u=gr(t,n+5);return e?{height:u.height,orientation:e,width:u.width}:u}t=t.slice(n+2)}throw new TypeError("Invalid JPG, no size found")}};var pt={};Object.defineProperty(pt,"__esModule",{value:!0}),pt.KTX=void 0;const Ir="KTX 11";pt.KTX={validate(t){return Ir===t.toString("ascii",1,7)},calculate(t){return{height:t.readUInt32LE(40),width:t.readUInt32LE(36)}}};var mt={};Object.defineProperty(mt,"__esModule",{value:!0}),mt.PNG=void 0;const wr=`PNG\r

`,Br="IHDR",ne="CgBI";mt.PNG={validate(t){if(wr===t.toString("ascii",1,8)){let e=t.toString("ascii",12,16);if(e===ne&&(e=t.toString("ascii",28,32)),e!==Br)throw new TypeError("Invalid PNG");return!0}return!1},calculate(t){return t.toString("ascii",12,16)===ne?{height:t.readUInt32BE(36),width:t.readUInt32BE(32)}:{height:t.readUInt32BE(20),width:t.readUInt32BE(16)}}};var It={};Object.defineProperty(It,"__esModule",{value:!0}),It.PNM=void 0;const ie={P1:"pbm/ascii",P2:"pgm/ascii",P3:"ppm/ascii",P4:"pbm",P5:"pgm",P6:"ppm",P7:"pam",PF:"pfm"},br=Object.keys(ie),ae={default:t=>{let e=[];for(;t.length>0;){const r=t.shift();if(r[0]!=="#"){e=r.split(" ");break}}if(e.length===2)return{height:parseInt(e[1],10),width:parseInt(e[0],10)};throw new TypeError("Invalid PNM")},pam:t=>{const e={};for(;t.length>0;){const r=t.shift();if(r.length>16||r.charCodeAt(0)>128)continue;const[n,u]=r.split(" ");if(n&&u&&(e[n.toLowerCase()]=parseInt(u,10)),e.height&&e.width)break}if(e.height&&e.width)return{height:e.height,width:e.width};throw new TypeError("Invalid PAM")}};It.PNM={validate(t){const e=t.toString("ascii",0,2);return br.includes(e)},calculate(t){const e=t.toString("ascii",0,2),r=ie[e],n=t.toString("ascii",3).split(/[\r\n]+/);return(ae[r]||ae.default)(n)}};var wt={};Object.defineProperty(wt,"__esModule",{value:!0}),wt.PSD=void 0,wt.PSD={validate(t){return t.toString("ascii",0,4)==="8BPS"},calculate(t){return{height:t.readUInt32BE(14),width:t.readUInt32BE(18)}}};var Bt={};Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.SVG=void 0;const oe=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/,bt={height:/\sheight=(['"])([^%]+?)\1/,root:oe,viewbox:/\sviewBox=(['"])(.+?)\1/,width:/\swidth=(['"])([^%]+?)\1/},Rt=2.54,Er={cm:96/Rt,em:16,ex:8,m:96/Rt*100,mm:96/Rt/10,pc:96/72/12,pt:96/72};function Et(t){const e=/([0-9.]+)([a-z]*)/.exec(t);if(e)return Math.round(parseFloat(e[1])*(Er[e[2]]||1))}function yr(t){const e=t.split(" ");return{height:Et(e[3]),width:Et(e[2])}}function vr(t){const e=t.match(bt.width),r=t.match(bt.height),n=t.match(bt.viewbox);return{height:r&&Et(r[2]),viewbox:n&&yr(n[2]),width:e&&Et(e[2])}}function Cr(t){return{height:t.height,width:t.width}}function Qr(t,e){const r=e.width/e.height;return t.width?{height:Math.floor(t.width/r),width:t.width}:t.height?{height:t.height,width:Math.floor(t.height*r)}:{height:e.height,width:e.width}}Bt.SVG={validate(t){const e=String(t);return oe.test(e)},calculate(t){const e=t.toString("utf8").match(bt.root);if(e){const r=vr(e[0]);if(r.width&&r.height)return Cr(r);if(r.viewbox)return Qr(r,r.viewbox)}throw new TypeError("Invalid SVG")}};var yt={};Object.defineProperty(yt,"__esModule",{value:!0}),yt.TIFF=void 0;const vt=ge,N=$;function _r(t,e,r){const n=N.readUInt(t,32,4,r);let u=1024;const f=vt.statSync(e).size;n+u>f&&(u=f-n-10);const a=nt.alloc(u),o=vt.openSync(e,"r");return vt.readSync(o,a,0,u,n),vt.closeSync(o),a.slice(2)}function xr(t,e){const r=N.readUInt(t,16,8,e);return(N.readUInt(t,16,10,e)<<16)+r}function Ur(t){if(t.length>24)return t.slice(12)}function Mr(t,e){const r={};let n=t;for(;n&&n.length;){const u=N.readUInt(n,16,0,e),f=N.readUInt(n,16,2,e),a=N.readUInt(n,32,4,e);if(u===0)break;a===1&&(f===3||f===4)&&(r[u]=xr(n,e)),n=Ur(n)}return r}function Dr(t){const e=t.toString("ascii",0,2);if(e==="II")return"LE";if(e==="MM")return"BE"}const jr=["49492a00","4d4d002a"];yt.TIFF={validate(t){return jr.includes(t.toString("hex",0,4))},calculate(t,e){if(!e)throw new TypeError("Tiff doesn't support buffer");const r=Dr(t)==="BE",n=_r(t,e,r),u=Mr(n,r),f=u[256],a=u[257];if(!f||!a)throw new TypeError("Invalid Tiff. Missing tags");return{height:a,width:f}}};var Ct={};Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.WEBP=void 0;function kr(t){return{height:1+t.readUIntLE(7,3),width:1+t.readUIntLE(4,3)}}function Pr(t){return{height:1+((t[4]&15)<<10|t[3]<<2|(t[2]&192)>>6),width:1+((t[2]&63)<<8|t[1])}}function Sr(t){return{height:t.readInt16LE(8)&16383,width:t.readInt16LE(6)&16383}}Ct.WEBP={validate(t){const e=t.toString("ascii",0,4)==="RIFF",r=t.toString("ascii",8,12)==="WEBP",n=t.toString("ascii",12,15)==="VP8";return e&&r&&n},calculate(t){const e=t.toString("ascii",12,16);if(t=t.slice(20,30),e==="VP8X"){const n=t[0],u=(n&192)===0,f=(n&1)===0;if(u&&f)return kr(t);throw new TypeError("Invalid WebP")}if(e==="VP8 "&&t[0]!==47)return Sr(t);const r=t.toString("hex",3,6);if(e==="VP8L"&&r!=="9d012a")return Pr(t);throw new TypeError("Invalid WebP")}},Object.defineProperty(Z,"__esModule",{value:!0}),Z.typeHandlers=void 0;const Rr=st,Or=At,Gr=ct,Hr=ht,Fr=ut,Lr=V,Tr=ft,qr=lt,Wr=dt,zr=pt,Yr=mt,Jr=It,Nr=wt,Kr=Bt,Xr=yt,Zr=Ct;Z.typeHandlers={bmp:Rr.BMP,cur:Or.CUR,dds:Gr.DDS,gif:Hr.GIF,icns:Fr.ICNS,ico:Lr.ICO,j2c:Tr.J2C,jp2:qr.JP2,jpg:Wr.JPG,ktx:zr.KTX,png:Yr.PNG,pnm:Jr.PNM,psd:Nr.PSD,svg:Kr.SVG,tiff:Xr.TIFF,webp:Zr.WEBP};var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.detector=void 0;const Ot=Z,Vr=Object.keys(Ot.typeHandlers),se={56:"psd",66:"bmp",68:"dds",71:"gif",73:"tiff",77:"tiff",82:"webp",105:"icns",137:"png",255:"jpg"};function $r(t){const e=t[0];if(e in se){const n=se[e];if(Ot.typeHandlers[n].validate(t))return n}const r=n=>Ot.typeHandlers[n].validate(t);return Vr.find(r)}Qt.detector=$r,function(t,e){var r=de&&de.__awaiter||function(l,d,p,m){function E(C){return C instanceof p?C:new p(function(_){_(C)})}return new(p||(p=Promise))(function(C,_){function x(B){try{b(m.next(B))}catch(M){_(M)}}function U(B){try{b(m.throw(B))}catch(M){_(M)}}function b(B){B.done?C(B.value):E(B.value).then(x,U)}b((m=m.apply(l,d||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.types=e.setConcurrency=e.imageSize=void 0;const n=ge,u=cn,f=Ne,a=Z,o=Qt,s=512*1024,h=new f.default({concurrency:100,autostart:!0});function c(l,d){const p=o.detector(l);if(p&&p in a.typeHandlers){const m=a.typeHandlers[p].calculate(l,d);if(m!==void 0)return m.type=p,m}throw new TypeError("unsupported file type: "+p+" (file: "+d+")")}function i(l){return r(this,void 0,void 0,function*(){const d=yield n.promises.open(l,"r"),{size:p}=yield d.stat();if(p<=0)throw yield d.close(),new Error("Empty file");const m=Math.min(p,s),E=nt.alloc(m);return yield d.read(E,0,m,0),yield d.close(),E})}function I(l){const d=n.openSync(l,"r"),{size:p}=n.fstatSync(d);if(p<=0)throw n.closeSync(d),new Error("Empty file");const m=Math.min(p,s),E=nt.alloc(m);return n.readSync(d,E,0,m,0),n.closeSync(d),E}t.exports=e=A,e.default=A;function A(l,d){if(nt.isBuffer(l))return c(l);if(typeof l!="string")throw new TypeError("invalid invocation");const p=u.resolve(l);if(typeof d=="function")h.push(()=>i(p).then(m=>An.nextTick(d,null,c(m,p))).catch(d));else{const m=I(p);return c(m,p)}}e.imageSize=A,e.setConcurrency=l=>{h.concurrency=l},e.types=Object.keys(a.typeHandlers)}(jt,jt.exports);var tn=jt.exports;const en=le(tn);Ie=function(t,e){var r=new XMLHttpRequest;r.onload=function(){var n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsDataURL(r.response)},r.open("GET",t),r.responseType="blob",r.send()},me=t=>{var e=en,r=t.split(";base64,").pop(),n=nt.from(r,"base64"),u=e(n);return u.width>128||u.height>128?(console.error("Image size check failed... returning"),{success:0,info:"Image size check failed, Image should be 128X128PX"}):(console.debug("Image verification",r.charAt(0)),r.charAt(0)==="/"?{success:1,info:"Image checks passed"}:r.charAt(0)==="i"?{success:1,info:"Image checks passed"}:{success:0,info:"Image extension should be jpg or png"})}});export{pe as I,un as __tla,me as h,Ie as t,we as u};
