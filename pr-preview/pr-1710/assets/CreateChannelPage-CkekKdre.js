import{m as e,B as t,e8 as h,em as ee,r,ft as ne,fu as Ae,e9 as F,D as te,z as B,dw as Ee,fv as M,fw as Le,dx as Ue,x as se,dy as Be,dA as Me,fx as ze,fy as Oe,dY as z,dZ as A,dX as O,fz as He,fA as Ge,fB as qe,fC as Je,__tla as Ve}from"./index-C03HJSIT.js";import{I as We,u as Ye,t as Ke,h as Xe,__tla as Ze}from"./LogoSizeHelper-DWSv5KDT.js";import{U as $e,b as Qe,i as en,m as nn,c as tn,__tla as sn}from"./UniswapWidget-CXXDODfv.js";import{C as rn,__tla as an}from"./ContentLayout-BBPfwtbt.js";import{__tla as on}from"./slicedToArray-D9ukL5_A.js";import{__tla as ln}from"./index.es-BMwmSEzu.js";import"./browser-CeceZ__e.js";let re,cn=Promise.all([(()=>{try{return Ve}catch{}})(),(()=>{try{return Ze}catch{}})(),(()=>{try{return sn}catch{}})(),(()=>{try{return an}catch{}})(),(()=>{try{return on}catch{}})(),(()=>{try{return ln}catch{}})()]).then(async()=>{const ae=({steps:s,setActiveStepIndex:o,activeStepIndex:i,config:n})=>{const c=d=>{var p,j;!((p=n==null?void 0:n.restrictedBackwardSteps)!=null&&p.includes(d))&&!((j=n==null?void 0:n.restrictedForwardSteps)!=null&&j.includes(d))&&o(d)};return e.jsx(t,{display:"flex",gap:"s8",children:s.map((d,p)=>e.jsxs(t,{display:"flex",flexDirection:"column",gap:"s3",width:"180px",cursor:"pointer",color:i==p?"pink-500":"gray-500",onClick:()=>c(p),children:[e.jsx(h,{textAlign:"center",variant:"h5-semibold",children:d.label}),e.jsx(t,{height:"4px",borderRadius:"r2",backgroundColor:i==p?"pink-500":"gray-500"})]},p))})},oe=s=>{const{svgProps:o,...i}=s;return e.jsx(ee,{componentName:"CloudUpload",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"inherit",height:"inherit",viewBox:"0 0 53 52",fill:"none",...o,children:[e.jsx("path",{d:"M16.1888 26.3978L26.7966 15.7901L37.4043 26.3978",stroke:"#C4CBD5","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M27.0618 50.0001V16.8509",stroke:"#C4CBD5","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M21.4927 35.4144H11.1502C8.05625 35.0608 1.86841 32.4972 1.86841 25.0718C1.86841 17.6464 8.05625 14.9061 11.1502 14.4641C11.769 10.3094 15.6585 2 26.2662 2C39.2607 2 41.0286 10.8398 41.9126 16.0553C45.0065 15.9669 51.4596 19.2906 51.4596 26.9282C51.2828 29.7569 49.6032 35.4144 44.2993 35.4144C38.9955 35.4144 34.1336 35.4144 32.3656 35.4144",stroke:"#C4CBD5","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"})]}),...i})},ie=s=>{const{svgProps:o,...i}=s;return e.jsx(ee,{componentName:"Swap",icon:e.jsxs("svg",{width:"inherit",height:"inherit",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o,children:[e.jsx("path",{d:"M13.25 5L5 13.25H27",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M18.75 27L27 18.75H5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]}),...i})},le=()=>e.jsxs(t,{display:"flex",flexDirection:"column",alignItems:"center",gap:"s1",alignSelf:"stretch",children:[e.jsx(h,{variant:"h3-semibold",color:{light:"gray-1000",dark:"gray-100"},children:"Create Your Channel"}),e.jsx(h,{variant:"bs-regular",color:{light:"gray-500",dark:"gray-600"},children:"Creating your own notification channel to manage, send and notify users."})]}),ce=s=>{var o=new RegExp("^((?:https|http):\\/\\/)((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return!!o.test(s)},C=s=>s.trim().length==0,de=({channelName:s,channelDesc:o,channelURL:i,errorInfo:n,setChannelName:c,setChannelDesc:d,setChannelURL:p,checkFormInput:j,setChannelInfoDone:I,setActiveStepIndex:x,handleNextStep:g})=>{const k=()=>!!(C(s)||C(o)||C(i)),f=r.useMemo(k,[s,o,i]);return e.jsxs(t,{display:"flex",flexDirection:"column",alignItems:"center",gap:"s10",alignSelf:"stretch",children:[e.jsxs(t,{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"s4",alignSelf:"stretch",children:[e.jsx(t,{width:"100%",children:e.jsx(ne,{required:!0,label:"Channel Name",value:s,onChange:a=>{c(a.target.value.slice(0,32))},error:!!(n!=null&&n.name),errorMessage:n.name,totalCount:32})}),e.jsx(t,{width:"100%",children:e.jsx(Ae,{required:!0,label:"Channel Description",placeholder:"Get notified about ...",description:"Enter a Brief description of the notifications the user will receive",error:!!(n!=null&&n.description),errorMessage:n.description,totalCount:250,value:o,onChange:a=>{d(a.target.value.slice(0,250))}})}),e.jsx(t,{width:"100%",children:e.jsx(ne,{label:"Channel Website URL",required:!0,value:i,onChange:a=>{p(a.target.value.slice(0,32))},error:!!(n!=null&&n.url),errorMessage:n.url,totalCount:32})})]}),e.jsx(F,{disabled:f,onClick:()=>{console.log("Next is clicked"),j()&&(I(!0),g(),x(1))},children:"Next"})]})},he=({view:s,imageSrc:o,imageType:i,croppedImage:n,setView:c,setImageSrc:d,setImageType:p,setCroppedImage:j,setUploadDone:I,setActiveStepIndex:x,handleNextStep:g})=>{const k=r.useRef(),f=async a=>{var P;if(j(void 0),c(!0),(P=a==null?void 0:a.files)==null?void 0:P[0]){var u=new FileReader;u.readAsDataURL(a==null?void 0:a.files[0]),u.onloadend=function(){var T,b;d(u.result),p((b=(T=a==null?void 0:a.files)==null?void 0:T[0])==null?void 0:b.type)}}else return"Nothing...."};return e.jsxs(t,{display:"flex",flexDirection:"column",gap:"s8",alignItems:"center",alignSelf:"stretch",children:[e.jsxs(t,{display:"flex",flexDirection:"column",alignItems:"center",gap:"s8",children:[e.jsx(h,{variant:"bes-regular",color:"gray-500",children:"Upload a PNG, JPG upto 1MB. Crop the image to resize to 128px."}),e.jsxs(t,{width:"500px",padding:"s12 s0",display:"flex",flexDirection:"column",alignItems:"center",border:{light:"1px dashed gray-300",dark:"1px dashed gray-700"},borderRadius:"r6",backgroundColor:{light:"gray-100",dark:"gray-1000"},gap:"s6",children:[s?n?e.jsx(t,{width:"128px",height:"128px",borderRadius:"r5",children:e.jsx("img",{style:{borderRadius:"inherit"},width:"100%",height:"100%",src:n,alt:"Cropped Img"})}):e.jsx(We,{width:"200px",height:"200px",imageSrc:o,imageType:i,onImageCropped:a=>j(a),ref:k}):e.jsx(oe,{size:50}),e.jsxs(t,{display:"flex",gap:"s1",children:[e.jsx(h,{variant:"bs-semibold",color:{light:"gray-1000",dark:"gray-600"},children:" Drag and Drop or"}),e.jsx("label",{htmlFor:"file-upload",children:e.jsx(h,{variant:"bs-semibold",color:{light:"pink-600",dark:"pink-400"},css:te`cursor:pointer;`,children:"Browse to Choose"})})]}),e.jsx("input",{id:"file-upload",accept:"image/*",name:"file-upload",hidden:!0,onChange:a=>{f(a.target)},type:"file",className:"sr-only",readOnly:!0})]})]}),!n&&s?e.jsx(F,{onClick:()=>{k.current.showCroppedImage()},children:"Crop Image"}):e.jsx(F,{disabled:!s&&!n,onClick:()=>{I(!0),g(),x(2)},children:"Next"})]})},pe=({mintPushToken:s,noOfPushTokensToCheck:o,mintingPush:i})=>{const n=B.appEnv==="prod",{isModalOpen:c,showModal:d,ModalComponent:p}=Ee();return e.jsxs(t,{display:"flex",padding:"s4 s6",backgroundColor:"pink-200",borderRadius:"r0 r0 r4 r4",justifyContent:"space-between",alignItems:"center",children:[e.jsx(M,{isLoading:i,children:e.jsx(h,{variant:"c-regular",color:"gray-1000",children:n?"Your balance is low. Swap to get PUSH Tokens.":"Follow these steps to get Testnet PUSH."})}),n?e.jsx(F,{size:"extraSmall",leadingIcon:e.jsx(ie,{}),onClick:d,children:"Swap PUSH Token"}):e.jsxs(t,{display:"flex",gap:"s3",children:[e.jsx(M,{isLoading:i,children:e.jsx(Le,{to:"https://chaindrop.org/?chainid=11155111&token=0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",target:"_blank",children:e.jsxs(t,{display:"flex",gap:"s2",alignItems:"baseline",color:"pink-600",cursor:"pointer",children:[e.jsx(t,{border:"1px solid pink-600",width:"16px",height:"15px",borderRadius:"r10",display:"flex",justifyContent:"center",children:e.jsx(h,{variant:"c-regular",children:"1"})}),e.jsx(h,{children:"Sepolia ETH Faucet"})]})})}),e.jsx(M,{isLoading:i,children:e.jsxs(t,{display:"flex",gap:"s2",alignItems:"baseline",color:"pink-600",cursor:"pointer",onClick:()=>s(1e3),children:[e.jsx(t,{border:"1px solid pink-600",width:"16px",height:"15px",borderRadius:"r10",display:"flex",justifyContent:"center",children:e.jsx(h,{variant:"c-regular",children:"2"})}),e.jsx(h,{children:"Get Testnet Push"})]})})]}),c&&e.jsx(p,{InnerComponent:$e,InnerComponentProps:{defaultPushTokenAmount:o},modalPadding:"0px",modalPosition:Ue.ON_ROOT})]})},ge=({channelStakeFees:s,handleCreateChannel:o,setStakeFeesChoosen:i})=>{const{provider:n,account:c,isWalletConnected:d,connect:p}=se(),{loading:j,error:I,executeAsyncFunction:x}=Ye(en),[g,k]=r.useState(0),[f,a]=r.useState(!1),u=async y=>{if(d||p(),d){a(!0);try{const _=await nn({noOfTokens:y,provider:n,account:c});console.log("Token Minted >>>",_),a(!1),k(_)}catch(_){console.log("Error >>",_),a(!1)}}},P=async()=>{console.log("Fetching token");const y=await tn({address:c,provider:n});console.log("Amount in the wallet >>",y),k(y)};r.useEffect(()=>{console.log("Balance useEffect is called",g),P(),L()},[g,c]);const T=async()=>{d&&await x()},[b,E]=r.useState(!1),L=async()=>{console.log("Checking if faucet should be displayed");const y=await Qe({address:c,provider:n,noOfPushTokensToCheck:50});console.log("Has Enough Push Token >>>",y),E(!y)};return e.jsxs(t,{display:"flex",flexDirection:"column",alignSelf:"stretch",justifyContent:"center",gap:"s10",children:[e.jsxs(t,{display:"flex",flexDirection:"column",gap:"s4",children:[e.jsxs(t,{display:"flex",flexDirection:"column",alignSelf:"stretch",children:[e.jsxs(t,{display:"flex",flexDirection:"row",justifyContent:"space-between",backgroundColor:{light:"gray-100",dark:"gray-1000"},borderRadius:b?"r4 r4 r0 r0":"r4",padding:"s4 s6",alignItems:"center",children:[e.jsx(h,{variant:"h4-semibold",color:{light:"gray-1000",dark:"gray-100"},children:"Amout For Staking"}),e.jsxs(t,{children:[e.jsxs(h,{variant:"h4-semibold",color:{light:"pink-500",dark:"pink-400"},children:[s," PUSH"]}),e.jsxs(h,{variant:"bes-semibold",color:"gray-500",children:["Balance: ",g==null?void 0:g.toLocaleString()]})]})]}),b&&e.jsx(pe,{mintPushToken:u,noOfPushTokensToCheck:50,mintingPush:f})]}),e.jsxs(t,{display:"flex",flexDirection:"row",gap:"s1",justifyContent:"center",children:[e.jsx(h,{variant:"bes-semibold",color:"gray-500",children:"Don't see Push token in your wallet?"}),e.jsx(h,{css:te`
              cursor: pointer;
            `,variant:"bes-semibold",color:"pink-500",onClick:T,children:"Import Token"})]})]}),e.jsx(t,{display:"flex",justifyContent:"center",children:e.jsx(F,{onClick:()=>{i(!0),o()},children:"Create Channel"})})]})},ue=[{label:"Channel Info"},{label:"Upload Logo"},{label:"Stake Fees"}],xe=50,fe=({progress:s,progressInfo:o,processingInfo:i})=>e.jsxs(t,{display:"flex",flexDirection:"column",alignSelf:"stretch",gap:"s10",alignItems:"center",children:[e.jsx(t,{padding:"s6",backgroundColor:{light:"gray-100",dark:"gray-1000"},borderRadius:"r4",width:"-webkit-fill-available",children:e.jsx(h,{textAlign:"center",variant:"h5-semibold",color:"pink-600",children:o})}),e.jsx(t,{width:"400px",children:e.jsx(Be,{percent:s,color:"#D548EC",backgroundColor:"#F3AEFF",height:"4px"})}),e.jsxs(t,{display:"flex",flexDirection:"row",alignItems:"center",gap:"s1",children:[e.jsx(Me,{type:ze.PROCESSING,size:16}),e.jsx(h,{variant:"bs-semibold",color:{light:"gray-800",dark:"gray-300"},children:i})]})]});B.coreContractChain;let H,G;H=B.coreContractChain,G=()=>{const{account:s,provider:o,chainId:i}=se(),[n,c]=r.useState(0),[d,p]=r.useState(xe),[j,I]=r.useState(50);let x=[];const[g,k]=r.useState(""),[f,a]=r.useState(""),[u,P]=r.useState("");r.useState(H);const[T,b]=r.useState(!1),[E,L]=r.useState(void 0),[y,_]=r.useState(void 0),[v,me]=r.useState(void 0),[q,Ce]=r.useState(void 0),[dn,je]=r.useState(!1),[hn,ke]=r.useState(!1),[pn,ye]=r.useState(!1),[we,w]=r.useState(0),[Se,D]=r.useState(""),[be,N]=r.useState(""),[ve,J]=r.useState(!1),[Ie,R]=r.useState({name:"",description:"",url:""}),V=()=>{n<2&&c(n+1)};x=x.filter(l=>l!==n),console.debug(x),r.useEffect(()=>{v&&(console.debug("Image cropped",v),Ke(v,function(l){const m=Xe(l);console.debug("response",m),m.success&&(console.debug("Cropped Image....",v),Ce(v))}))},[v]);const Pe=async()=>{let l=await new z(A.pushToken,O.pushToken,o).allowance(s,A.epnscore);l=l==null?void 0:l.toString();const m=Je(l);return console.log("Number value >>>",m,Number(m)),I(Number(m)),Number(m)},W=()=>(R(()=>({name:"",description:"",url:""})),C(g)||C(f)||C(u)?(C(g)&&R(l=>({...l,name:"Please, enter the channel name."})),C(f)&&R(l=>({...l,description:"Please, enter the channel description"})),C(u)&&R(l=>({...l,url:"Please, enter the channel url"})),!1):ce(u)?!0:(R(l=>({...l,url:"Channel URL is invalid! Please enter a valid url!"})),!1)),Te=async()=>{if(!W){console.log("Errors are present in channel Info");return}if(!q){console.log("Channel Logo is not correct");return}J(!0);const l=await Pe();console.log("Approved Token Amount >>",l);let m={name:g,info:f,url:u,icon:q};console.log("Channel Input before  >>",m);const Y=JSON.stringify(m);w(0),console.log("Channel Input after>>",Y),N("Loading..."),D("Please wait, payload is getting uploaded to IPFS."),w(5);let K=await Oe(Y);console.log("IPFS storagePointer:",K),N("Payload Uploaded"),D("Please complete the transaction in your wallet to continue."),w(10);var U=o.getSigner(s);console.debug(U);let _e=new z(A.pushToken,O.pushToken,U);const X=He(d.toString(),18);try{if(l<50){var De=_e.approve(A.epnscore,X);const Q=await De;console.debug(Q),console.debug("waiting for tx to finish"),w(30),await o.waitForTransaction(Q.hash)}let S=new z(A.epnscore,O.epnscore,U),Ne=Ge.GENERAL;const Re="1+"+K,Fe=qe(Re);w(50),console.log("Processing contract wait ser");const Z=await S.createChannelWithPUSH(Ne,Fe,X,0,{gasLimit:6e5});console.debug(Z),console.debug("Check: "+s);let $=await o.waitForTransaction(Z.hash);console.log("Tx Check >>>",$),$.status===0?(console.log("Channel Not created their is an error>>"),c(1)):(w(60),D("Please wait while we confirm the transaction."),N("Transaction Confirmed"),setTimeout(()=>{w(80),D("Creating your channel, Aligning pixels, adjusting padding... This may take some time."),N("Redirecting... Please do not refresh"),w(90)},2e3))}catch(S){S.code===4001||S.code==="ACTION_REJECTED"?console.log("Signature error ",S):(console.error("Error --> %o",S),console.error({error:S}),w(0),D("There was an error in creating the Channel"),N("Kindly Contact support@epns.io to resolve the issue.")),console.log("Error in the transaction >>",S),J(!1)}};return e.jsxs(t,{padding:"s8",backgroundColor:{light:"white",dark:"gray-900"},borderRadius:"r8",width:"584px",display:"flex",flexDirection:"column",alignItems:"center",gap:"s10",children:[e.jsx(le,{}),ve?e.jsx(fe,{progress:we,processingInfo:be,progressInfo:Se}):e.jsxs(t,{display:"flex",flexDirection:"column",gap:"s8",alignItems:"center",alignSelf:"stretch",children:[e.jsx(ae,{steps:ue,activeStepIndex:n,setActiveStepIndex:c,config:{restrictedForwardSteps:x}}),n==0&&e.jsx(de,{channelName:g,channelDesc:f,channelURL:u,errorInfo:Ie,setChannelName:k,setChannelDesc:a,setChannelURL:P,checkFormInput:W,setChannelInfoDone:je,setActiveStepIndex:c,handleNextStep:V}),n===1&&e.jsx(he,{view:T,imageSrc:E,imageType:y,croppedImage:v,setView:b,setImageSrc:L,setImageType:_,setCroppedImage:me,setUploadDone:ke,setActiveStepIndex:c,handleNextStep:V}),n===2&&e.jsx(ge,{channelStakeFees:d,handleCreateChannel:Te,setStakeFeesChoosen:ye})]})]})},re=()=>e.jsx(rn,{children:e.jsx(G,{})})});export{cn as __tla,re as default};
