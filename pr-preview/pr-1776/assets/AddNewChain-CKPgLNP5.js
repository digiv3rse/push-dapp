import{dL as Y,dM as Q,bd as U,bc as Z,aZ as e,dN as B,bg as o,dO as N,dP as G,bM as m,b9 as H,b7 as y,c1 as u,bP as E,dd as K,bL as J,c_ as R,dl as W,bb as X,dg as V,bh as $,dQ as ee,dR as ae,__tla as se}from"./index-DYy5A60q.js";import{u as F,__tla as ne}from"./useMutation-DYGH4B1p.js";import{i as ie,S as te,__tla as re}from"./ValidationHelper-D3agMFfs.js";import{c as le,a as L,u as oe,F as ce,b as de,__tla as he}from"./index.esm-kzwd2j5X.js";import{C as ue,__tla as pe}from"./ContentLayout-DnjFyP1w.js";let q,ge=Promise.all([(()=>{try{return se}catch{}})(),(()=>{try{return ne}catch{}})(),(()=>{try{return re}catch{}})(),(()=>{try{return he}catch{}})(),(()=>{try{return pe}catch{}})()]).then(async()=>{let b,f,j,w,I,S,v,_,C,k,p,A,D,M,P;b=a=>a,f=a=>a,j=({userPushSDKInstance:a,alias:s})=>a.channel.alias.initiate(s).then(b),w=({userPushSDKInstance:a,alias:s})=>a.channel.alias.verify(s).then(f),I=()=>F({mutationKey:[Y],mutationFn:j}),S=()=>F({mutationKey:[Q],mutationFn:w}),v=[{label:"New Address",value:"newaddress"},{label:"Change Network",value:"changenetwork"},{label:"Verify Alias Chain",value:"verifyalias"}],_=()=>U.allowedNetworks.map(a=>{const s=B[a];return{value:a.toString(),label:Z[a],icon:e.jsx(s,{})}}),C=le().shape({alias:L().required("Address is required").test("is-valid-address","Invalid wallet address",ie),chainId:L().required("ChainId is required")}),k=({children:a,onSubmit:s})=>{const i=oe({initialValues:{alias:"",chainId:"11155111"},validationSchema:C,onSubmit:s});return e.jsx(ce,{value:i,children:a})},p=()=>{const a=de();if(!a)throw new Error("useChainAliasFormikContext must be used within a FormikChainAliasProvider");return a},A=({isLoading:a})=>{const s=_(),{values:i,handleSubmit:c,handleChange:l,errors:t,touched:n}=p();return e.jsx(o,{width:"100%",children:e.jsx("form",{onSubmit:c,children:e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",gap:"spacing-xl",children:[e.jsxs(o,{display:"flex",flexDirection:{ml:"column",dp:"row"},gap:"spacing-xs",alignItems:"flex-start",width:"100%",children:[e.jsx(N,{label:"Your Address on New Chain",description:"Make sure you own this alias as verification will take place.",value:i.alias,onChange:l("alias"),error:(n==null?void 0:n.alias)&&!!(t!=null&&t.alias),errorMessage:n!=null&&n.alias?t==null?void 0:t.alias:""}),e.jsx(o,{display:"flex",alignSelf:"center",width:{dp:"auto",ml:"100%"},margin:"spacing-xxxs spacing-none spacing-none spacing-none",children:e.jsx(G,{options:s,value:i.chainId,onSelect:l("chainId"),error:(n==null?void 0:n.chainId)&&!!(t!=null&&t.chainId),errorMessage:n!=null&&n.chainId?t.chainId:""})})]}),e.jsx(m,{disabled:!i.alias||a,variant:"primary",children:a?"Initiating":"Add"})]})})})},D=({handleNextStep:a})=>{const{switchChain:s,chainId:i}=H(),{values:c}=p(),l=parseInt(c.chainId);return y.useEffect(()=>{i===l&&a("verifyalias")},[i]),e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsx(u,{variant:"bs-semibold",color:"text-primary",children:"Switch to the desired chain in your wallet to add it to your channel."}),e.jsx(m,{onClick:()=>s(l),children:"Change Network"})]})},M=()=>{const{userPushSDKInstance:a}=E(d=>d.user),{mutate:s,isPending:i}=S(),{values:c}=p(),l=K(),t=J(),n=parseInt(c.chainId),g=c.alias,h=()=>{s({userPushSDKInstance:a,alias:R(g,n)},{onSuccess:()=>{l.showMessageToast({toastTitle:"Success",toastMessage:"Verification Successful",toastType:"SUCCESS",getToastIcon:d=>e.jsx(W,{size:d,color:"green"})}),t(X.Dashboard)},onError:d=>{d&&l.showMessageToast({toastTitle:"Error",toastMessage:d.message,toastType:"ERROR",getToastIcon:x=>e.jsx(V,{size:x,color:"red"})})}})};return e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-xl",alignItems:"center",children:[e.jsxs(o,{display:"flex",flexDirection:"column",gap:"spacing-sm",children:[e.jsxs(u,{variant:"bs-semibold",textAlign:"center",color:"text-primary",children:["You\u2019re almost there!",e.jsx("br",{})," Verify the address on the new chain to send notifications."]}),e.jsx(N,{disabled:!0,value:g})]}),e.jsx(m,{onClick:h,disabled:i,children:i?"Verifying":"Verify New Address"})]})},P=()=>{const[a,s]=y.useState("newaddress"),[i,c]=y.useState(["newaddress"]),l=K(),{mutate:t,isPending:n,isError:g}=I(),{userPushSDKInstance:h}=E(r=>r.user),d=(r,z)=>{t({userPushSDKInstance:h,alias:R(r,parseInt(z))},{onSuccess:()=>{x("changenetwork")},onError:T=>{T&&l.showMessageToast({toastTitle:"Error",toastMessage:T.message,toastType:"ERROR",getToastIcon:O=>e.jsx(V,{size:O,color:"red"})})}})},x=r=>{c([...new Set([...i,r])]),s(r)};return e.jsx(k,{onSubmit:r=>d(r.alias,r.chainId),children:e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",margin:{ml:"spacing-lg spacing-md",dp:"spacing-lg spacing-none spacing-none spacing-none"},padding:{dp:"spacing-lg",ml:"spacing-sm"},gap:"spacing-lg",borderRadius:"radius-lg",backgroundColor:"surface-primary",children:[e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",gap:"spacing-xxxs",children:[e.jsx(u,{color:"text-primary",variant:"h3-semibold",display:{ml:"none",dp:"block"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-primary",variant:"h4-semibold",display:{ml:"block",dp:"none"},children:"Add New Chain to Channel"}),e.jsx(u,{color:"text-tertiary",variant:"bs-regular",display:{ml:"none",dp:"block"},children:"Add an alias chain to your channel to enable notifications to that chain."}),e.jsx(u,{display:{ml:"block",dp:"none"},color:"text-tertiary",variant:"bes-regular",children:"Add an alias chain to your channel to enable notifications to that chain."})]}),e.jsx(te,{steps:v,completedSteps:i,setActiveStepKey:r=>s(r)}),a==="newaddress"&&e.jsx(A,{isLoading:n&&!g}),a==="changenetwork"&&e.jsx(D,{handleNextStep:x}),a==="verifyalias"&&e.jsx(M,{}),h&&(h==null?void 0:h.readmode())&&e.jsx(o,{display:"flex",justifyContent:"center",width:"-webkit-fill-available",alignItems:"center",css:$`
              z-index: 99999;
            `,children:e.jsx(ee,{type:ae.MODAL,showConnectModal:!0})})]})})},q=()=>e.jsx(ue,{children:e.jsx(P,{})})});export{ge as __tla,q as default};
